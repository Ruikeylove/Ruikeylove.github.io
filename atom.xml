<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RuikeyğŸ¥</title>
  
  
  <link href="https://ruikey.cn/atom.xml" rel="self"/>
  
  <link href="https://ruikey.cn/"/>
  <updated>2024-08-12T14:30:00.000Z</updated>
  <id>https://ruikey.cn/</id>
  
  <author>
    <name>RuikeyğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MovieLens 1Mæ•°æ®é›†æ•°æ®åˆ†æ</title>
    <link href="https://ruikey.cn/posts/af4a064c.html"/>
    <id>https://ruikey.cn/posts/af4a064c.html</id>
    <published>2024-08-11T10:25:15.000Z</published>
    <updated>2024-08-12T14:30:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1>MovieLens 1Mæ•°æ®é›†</h1><p>è¿™ä¸ªæ•°æ®é›†æ˜¯ç”µå½±è¯„åˆ†æ•°æ®ï¼šåŒ…æ‹¬ç”µå½±è¯„åˆ†ï¼Œç”µå½±å…ƒæ•°æ®ï¼ˆé£æ ¼ç±»å‹ï¼Œå¹´ä»£ï¼‰ä»¥åŠå…³äºç”¨æˆ·çš„äººå£ç»Ÿè®¡å­¦æ•°æ®ï¼ˆå¹´é¾„ï¼Œé‚®ç¼–ï¼Œæ€§åˆ«ï¼ŒèŒä¸šç­‰ï¼‰ã€‚</p><p>MovieLens 1Mæ•°æ®é›†è¯„åˆ†ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œç”µå½±ä¿¡æ¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Make display smaller</span></span><br><span class="line">pd.options.display.max_rows = <span class="number">10</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">unames = [<span class="string">&#x27;user_id&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;occupation&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>]</span><br><span class="line">users = pd.read_table(<span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/users.dat&#x27;</span>, sep=<span class="string">&#x27;::&#x27;</span>, </span><br><span class="line">                      header=<span class="literal">None</span>, names=unames)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å° users DataFrame çš„å‰å‡ è¡Œä»¥éªŒè¯æ•°æ®åŠ è½½æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="built_in">print</span>(users.head())</span><br></pre></td></tr></table></figure><pre><code>   user_id gender  age  occupation    zip0        1      F    1          10  480671        2      M   56          16  700722        3      M   25          15  551173        4      M   45           7  024604        5      M   25          20  55455C:\Users\28696\AppData\Local\Temp\ipykernel_21476\1541965289.py:2: ParserWarning: Falling back to the 'python' engine because the 'c' engine does not support regex separators (separators &gt; 1 char and different from '\s+' are interpreted as regex); you can avoid this warning by specifying engine='python'.  users = pd.read_table('C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/users.dat', sep='::',</code></pre><p>å› ä¸ºsep='::'æœ‰ç‚¹åƒæ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œäºæ˜¯æœ‰äº†ä¸Šé¢çš„é”™è¯¯ã€‚è§£å†³æ–¹æ³•åœ¨è¿™ä¸ªè®¾ç½®engineä¸ºpythonå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">users = pd.read_table(<span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/users.dat&#x27;</span>, sep=<span class="string">&#x27;::&#x27;</span>, </span><br><span class="line">                      header=<span class="literal">None</span>, names=unames, engine=<span class="string">&#x27;python&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rnames = [<span class="string">&#x27;user_id&#x27;</span>, <span class="string">&#x27;movie_id&#x27;</span>, <span class="string">&#x27;rating&#x27;</span>, <span class="string">&#x27;timestamp&#x27;</span>]</span><br><span class="line">ratings = pd.read_table(<span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/ratings.dat&#x27;</span>, sep=<span class="string">&#x27;::&#x27;</span>, </span><br><span class="line">                        header=<span class="literal">None</span>, names=rnames, engine=<span class="string">&#x27;python&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_path = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/movies.dat&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    raw_data = f.read()</span><br><span class="line">    encoding = chardet.detect(raw_data)[<span class="string">&#x27;encoding&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Detected encoding: <span class="subst">&#123;encoding&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><pre><code>Detected encoding: ISO-8859-1</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰åˆ—å</span></span><br><span class="line">mnames = [<span class="string">&#x27;movie_id&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;genres&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ£€æµ‹åˆ°çš„ç¼–ç è¯»å–æ•°æ®</span></span><br><span class="line">movies = pd.read_table(file_path, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=mnames, engine=<span class="string">&#x27;python&#x27;</span>, encoding=encoding)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¾ç¤ºç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(genre_counts_for_rating_5)</span><br></pre></td></tr></table></figure><pre><code>Action        52187Adventure     26608Animation     10795Children's    13574Comedy        73530              ...  Romance       32059Sci-Fi        32441Thriller      41408War           23423Western        4965Length: 18, dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">genre_counts_for_rating_5.plot(kind=<span class="string">&#x27;bar&#x27;</span>, color=<span class="string">&#x27;skyblue&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">f&#x27;Count of Movies with Rating <span class="subst">&#123;rating&#125;</span>&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Genre&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">f&#x27;Count of Rating <span class="subst">&#123;rating&#125;</span>&#x27;</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>---------------------------------------------------------------------------NameError                                 Traceback (most recent call last)Cell In[64], line 2      1 genre_counts_for_rating_5.plot(kind='bar', color='skyblue')----&gt; 2 plt.title(f'Count of Movies with Rating &#123;rating&#125;')      3 plt.xlabel('Genre')      4 plt.ylabel(f'Count of Rating &#123;rating&#125;')NameError: name 'plt' is not defined</code></pre><p><img src="https://file.imgcc.cloud/images/2024/08/13/f53d7970651d99b9285260addb04b955.png" alt="output 11 1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»Ÿè®¡æ‰€æœ‰ç”µå½±çš„è¯„åˆ†æ•°é‡</span></span><br><span class="line">rating_counts = data[<span class="string">&#x27;rating&#x27;</span>].value_counts()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ¯ä¸ªè¯„åˆ†çš„å æ¯”</span></span><br><span class="line">rating_counts_percentage = (rating_counts / rating_counts.<span class="built_in">sum</span>()) * <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰é¢œè‰²åˆ—è¡¨</span></span><br><span class="line">colors = [<span class="string">&#x27;#ff9999&#x27;</span>,<span class="string">&#x27;#66b3ff&#x27;</span>,<span class="string">&#x27;#99ff99&#x27;</span>,<span class="string">&#x27;#ffcc99&#x27;</span>,<span class="string">&#x27;#c2c2f0&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ– - é¥¼çŠ¶å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))  <span class="comment"># è®¾ç½®å›¾å½¢å¤§å°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¥¼çŠ¶å›¾ï¼ŒåŒ…æ‹¬ç™¾åˆ†æ¯”å’Œæ•°é‡</span></span><br><span class="line"><span class="comment"># ç»˜åˆ¶é¥¼å›¾ï¼ŒåŒ…æ‹¬ç™¾åˆ†æ¯”å’Œæ•°é‡</span></span><br><span class="line">plt.pie(rating_counts, labels=[<span class="built_in">str</span>(<span class="string">f&#x27;<span class="subst">&#123;rating&#125;</span>: <span class="subst">&#123;count&#125;</span> (<span class="subst">&#123;<span class="built_in">round</span>(percentage, <span class="number">1</span>)&#125;</span>%)&#x27;</span>) <span class="keyword">for</span> rating, count, percentage <span class="keyword">in</span> <span class="built_in">zip</span>(rating_counts.index, rating_counts.values, rating_counts_percentage.values)], autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, startangle=<span class="number">140</span>, colors=colors)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å›¾è¡¨æ ‡é¢˜</span></span><br><span class="line">plt.title(<span class="string">&#x27;Movie Rating Distribution&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾è¡¨</span></span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)  <span class="comment"># ä¿æŒé¥¼çŠ¶å›¾ä¸ºåœ†å½¢</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>â€‹<br><img src="https://file.imgcc.cloud/images/2024/08/13/60bea2691a95187b49d9b28951b8b6d6.png" alt="output 12 0"><br>â€‹</p><p>åŠ è½½å‰å‡ è¡ŒéªŒè¯ä¸€ä¸‹æ•°æ®åŠ è½½å·¥ä½œæ˜¯å¦é¡ºåˆ©</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">users[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>user_id</th>      <th>gender</th>      <th>age</th>      <th>occupation</th>      <th>zip</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1</td>      <td>F</td>      <td>1</td>      <td>10</td>      <td>48067</td>    </tr>    <tr>      <th>1</th>      <td>2</td>      <td>M</td>      <td>56</td>      <td>16</td>      <td>70072</td>    </tr>    <tr>      <th>2</th>      <td>3</td>      <td>M</td>      <td>25</td>      <td>15</td>      <td>55117</td>    </tr>    <tr>      <th>3</th>      <td>4</td>      <td>M</td>      <td>45</td>      <td>7</td>      <td>02460</td>    </tr>    <tr>      <th>4</th>      <td>5</td>      <td>M</td>      <td>25</td>      <td>20</td>      <td>55455</td>    </tr>  </tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ratings[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>user_id</th>      <th>movie_id</th>      <th>rating</th>      <th>timestamp</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1</td>      <td>1193</td>      <td>5</td>      <td>978300760</td>    </tr>    <tr>      <th>1</th>      <td>1</td>      <td>661</td>      <td>3</td>      <td>978302109</td>    </tr>    <tr>      <th>2</th>      <td>1</td>      <td>914</td>      <td>3</td>      <td>978301968</td>    </tr>    <tr>      <th>3</th>      <td>1</td>      <td>3408</td>      <td>4</td>      <td>978300275</td>    </tr>    <tr>      <th>4</th>      <td>1</td>      <td>2355</td>      <td>5</td>      <td>978824291</td>    </tr>  </tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">movies[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>movie_id</th>      <th>title</th>      <th>genres</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1</td>      <td>Toy Story (1995)</td>      <td>Animation|Children's|Comedy</td>    </tr>    <tr>      <th>1</th>      <td>2</td>      <td>Jumanji (1995)</td>      <td>Adventure|Children's|Fantasy</td>    </tr>    <tr>      <th>2</th>      <td>3</td>      <td>Grumpier Old Men (1995)</td>      <td>Comedy|Romance</td>    </tr>    <tr>      <th>3</th>      <td>4</td>      <td>Waiting to Exhale (1995)</td>      <td>Comedy|Drama</td>    </tr>    <tr>      <th>4</th>      <td>5</td>      <td>Father of the Bride Part II (1995)</td>      <td>Comedy</td>    </tr>  </tbody></table></div><p>æ³¨æ„ï¼Œå¹´é¾„å’ŒèŒä¸šæ˜¯ä»¥ç¼–ç å½¢å¼ç»™å‡ºçš„ï¼Œå®ƒä»¬çš„å…·ä½“å«ä¹‰è¯·å‚è€ƒæ”¹æ•°æ®é›†çš„REAMDEæ–‡ä»¶ã€‚åˆ†ææ•£å¸ƒåœ¨ä¸‰ä¸ªè¡¨ä¸­çš„æ•°æ®ä¸æ˜¯ä¸€ä»¶è½»æ¾çš„äº‹æƒ…ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦æ ¹æ®æ€§åˆ«å’Œå¹´é¾„æ¥è®¡ç®—æŸéƒ¨ç”µå½±çš„å¹³å‡å¾—åˆ†ï¼Œå¦‚æœå°†æ‰€æœ‰çš„æ•°æ®éƒ½åˆå¹¶åˆ°ä¸€ä¸ªè¡¨ä¸­çš„è¯ï¼Œé—®é¢˜å°±ç®€å•å¤šäº†ã€‚æˆ‘ä»¬å…ˆç”¨pandasçš„mergeå‡½æ•°å°†ratingså’Œusersåˆå¹¶åˆ°ä¸€èµ·ï¼Œç„¶åå†å°†moviesä¹Ÿåˆå¹¶è¿›å»ã€‚pandasä¼šæ ¹æ®åˆ—åçš„é‡å æƒ…å†µæ¨æ–­å‡ºå“ªäº›åˆ—æ˜¯åˆå¹¶ï¼ˆæˆ–è¿æ¥ï¼‰é”®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = pd.merge(pd.merge(ratings, users), movies)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.head()</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>user_id</th>      <th>movie_id</th>      <th>rating</th>      <th>timestamp</th>      <th>gender</th>      <th>age</th>      <th>occupation</th>      <th>zip</th>      <th>title</th>      <th>genres</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1</td>      <td>1193</td>      <td>5</td>      <td>978300760</td>      <td>F</td>      <td>1</td>      <td>10</td>      <td>48067</td>      <td>One Flew Over the Cuckoo's Nest (1975)</td>      <td>Drama</td>    </tr>    <tr>      <th>1</th>      <td>2</td>      <td>1193</td>      <td>5</td>      <td>978298413</td>      <td>M</td>      <td>56</td>      <td>16</td>      <td>70072</td>      <td>One Flew Over the Cuckoo's Nest (1975)</td>      <td>Drama</td>    </tr>    <tr>      <th>2</th>      <td>12</td>      <td>1193</td>      <td>4</td>      <td>978220179</td>      <td>M</td>      <td>25</td>      <td>12</td>      <td>32793</td>      <td>One Flew Over the Cuckoo's Nest (1975)</td>      <td>Drama</td>    </tr>    <tr>      <th>3</th>      <td>15</td>      <td>1193</td>      <td>4</td>      <td>978199279</td>      <td>M</td>      <td>25</td>      <td>7</td>      <td>22903</td>      <td>One Flew Over the Cuckoo's Nest (1975)</td>      <td>Drama</td>    </tr>    <tr>      <th>4</th>      <td>17</td>      <td>1193</td>      <td>5</td>      <td>978158471</td>      <td>M</td>      <td>50</td>      <td>1</td>      <td>95350</td>      <td>One Flew Over the Cuckoo's Nest (1975)</td>      <td>Drama</td>    </tr>  </tbody></table></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><pre><code>user_id                                            1movie_id                                        1193rating                                             5timestamp                                  978300760gender                                             Fage                                                1occupation                                        10zip                                            48067title         One Flew Over the Cuckoo's Nest (1975)genres                                         DramaName: 0, dtype: object</code></pre><p>åˆ—å‡ºè¯„åˆ†æœ€é«˜çš„åéƒ¨ç”µå½±</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">movies_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/movies.dat&#x27;</span></span><br><span class="line">ratings_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/ratings.dat&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–ç”µå½±æ•°æ®é›†</span></span><br><span class="line">movies = pd.read_csv(movies_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=[<span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;genres&#x27;</span>], engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–è¯„åˆ†æ•°æ®é›†</span></span><br><span class="line">ratings = pd.read_csv(ratings_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=[<span class="string">&#x27;userId&#x27;</span>, <span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;rating&#x27;</span>, <span class="string">&#x27;timestamp&#x27;</span>], engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶ç”µå½±å’Œè¯„åˆ†æ•°æ®é›†ï¼Œè®¡ç®—æ¯éƒ¨ç”µå½±çš„å¹³å‡è¯„åˆ†</span></span><br><span class="line">movie_ratings = pd.merge(movies, ratings, on=<span class="string">&#x27;movieId&#x27;</span>)</span><br><span class="line">average_ratings = movie_ratings.groupby(<span class="string">&#x27;title&#x27;</span>)[<span class="string">&#x27;rating&#x27;</span>].mean().reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰å¹³å‡è¯„åˆ†é™åºæ’åˆ—å¹¶é€‰æ‹©å‰10éƒ¨ç”µå½±</span></span><br><span class="line">top_movies = average_ratings.sort_values(by=<span class="string">&#x27;rating&#x27;</span>, ascending=<span class="literal">False</span>).head(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºè¯„åˆ†æœ€é«˜çš„åéƒ¨ç”µå½±</span></span><br><span class="line"><span class="built_in">print</span>(top_movies)</span><br></pre></td></tr></table></figure><pre><code>                                          title  rating3477                    Ulysses (Ulisse) (1954)     5.02025                               Lured (1947)     5.01203                    Follow the Bitch (1998)     5.0407                    Bittersweet Motel (2000)     5.03087                     Song of Freedom (1936)     5.02453                   One Little Indian (1973)     5.03044                       Smashing Time (1967)     5.02903  Schlafes Bruder (Brother of Sleep) (1995)     5.01297         Gate of Heavenly Peace, The (1995)     5.0249                            Baby, The (1973)     5.0</code></pre><p>æ ¹æ®ä»»æ„ä¸ªç”¨æˆ·æˆ–ç”µå½±å±æ€§å¯¹è¯„åˆ†æ•°æ®è¿›è¡Œèšåˆæ“ä½œäº†ã€‚æŒ‰æ€§åˆ«è®¡ç®—æ¯éƒ¨ç”µå½±çš„å¹³å‡å¾—åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pivot_tableæ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mean_ratings = data.pivot_table(<span class="string">&#x27;rating&#x27;</span>, index=<span class="string">&#x27;title&#x27;</span>,</span><br><span class="line">                                columns=<span class="string">&#x27;gender&#x27;</span>, aggfunc=<span class="string">&#x27;mean&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mean_ratings[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>gender</th>      <th>F</th>      <th>M</th>    </tr>    <tr>      <th>title</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>$1,000,000 Duck (1971)</th>      <td>3.375000</td>      <td>2.761905</td>    </tr>    <tr>      <th>'Night Mother (1986)</th>      <td>3.388889</td>      <td>3.352941</td>    </tr>    <tr>      <th>'Til There Was You (1997)</th>      <td>2.675676</td>      <td>2.733333</td>    </tr>    <tr>      <th>'burbs, The (1989)</th>      <td>2.793478</td>      <td>2.962085</td>    </tr>    <tr>      <th>...And Justice for All (1979)</th>      <td>3.828571</td>      <td>3.689024</td>    </tr>  </tbody></table></div><p>è¯¥æ“ä½œäº§ç”Ÿäº†å¦ä¸€ä¸ªDataFrameï¼Œå…¶å†…å®¹ä¸ºç”µå½±å¹³å‡å¾—åˆ†ï¼Œè¡Œæ ‡ä¸ºç”µå½±åç§°ï¼Œåˆ—è¡¨ä¸ºæ€§åˆ«ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ‰“ç®—è¿‡æ»¤æ‰è¯„åˆ†æ•°æ®ä¸å¤Ÿ250æ¡çš„ç”µå½±ï¼ˆè¿™ä¸ªæ•°å­—å¯ä»¥è‡ªå·±è®¾å®šï¼‰ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬å…ˆå¯¹titleè¿›è¡Œåˆ†ç»„ï¼Œç„¶ååˆ©ç”¨size()å¾—åˆ°ä¸€ä¸ªå«æœ‰å„ç”µå½±åˆ†ç»„å¤§å°çš„Serieså¯¹è±¡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ratings_by_title = data.groupby(<span class="string">&#x27;title&#x27;</span>).size()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ratings_by_title[:<span class="number">10</span>]</span><br></pre></td></tr></table></figure><pre><code>title$1,000,000 Duck (1971)                37'Night Mother (1986)                  70'Til There Was You (1997)             52'burbs, The (1989)                   303...And Justice for All (1979)        1991-900 (1994)                           210 Things I Hate About You (1999)    700101 Dalmatians (1961)                565101 Dalmatians (1996)                36412 Angry Men (1957)                  616dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">active_titles = ratings_by_title.index[ratings_by_title &gt;= <span class="number">250</span>]</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(active_titles)</span><br></pre></td></tr></table></figure><pre><code>Index([''burbs, The (1989)', '10 Things I Hate About You (1999)',       '101 Dalmatians (1961)', '101 Dalmatians (1996)', '12 Angry Men (1957)',       '13th Warrior, The (1999)', '2 Days in the Valley (1996)',       '20,000 Leagues Under the Sea (1954)', '2001: A Space Odyssey (1968)',       '2010 (1984)',       ...       'X-Men (2000)', 'Year of Living Dangerously (1982)',       'Yellow Submarine (1968)', 'You've Got Mail (1998)',       'Young Frankenstein (1974)', 'Young Guns (1988)',       'Young Guns II (1990)', 'Young Sherlock Holmes (1985)',       'Zero Effect (1998)', 'eXistenZ (1999)'],      dtype='object', name='title', length=1216)</code></pre><p>ä¸Šé¢çš„active_titlesä¸­çš„ç”µå½±ï¼Œéƒ½æ˜¯è¯„è®ºæ˜¯å¤§äº250æ¡ä»¥ä¸Šçš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›æ ‡é¢˜ä½œä¸ºç´¢å¼•ï¼Œä»mean_ratingsä¸­é€‰å‡ºè¿™äº›è¯„è®ºå¤§äº250æ¡çš„ç”µå½±ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mean_ratings = mean_ratings.loc[active_titles]</span><br><span class="line">mean_ratings</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>gender</th>      <th>F</th>      <th>M</th>    </tr>    <tr>      <th>title</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>'burbs, The (1989)</th>      <td>2.793478</td>      <td>2.962085</td>    </tr>    <tr>      <th>10 Things I Hate About You (1999)</th>      <td>3.646552</td>      <td>3.311966</td>    </tr>    <tr>      <th>101 Dalmatians (1961)</th>      <td>3.791444</td>      <td>3.500000</td>    </tr>    <tr>      <th>101 Dalmatians (1996)</th>      <td>3.240000</td>      <td>2.911215</td>    </tr>    <tr>      <th>12 Angry Men (1957)</th>      <td>4.184397</td>      <td>4.328421</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>Young Guns (1988)</th>      <td>3.371795</td>      <td>3.425620</td>    </tr>    <tr>      <th>Young Guns II (1990)</th>      <td>2.934783</td>      <td>2.904025</td>    </tr>    <tr>      <th>Young Sherlock Holmes (1985)</th>      <td>3.514706</td>      <td>3.363344</td>    </tr>    <tr>      <th>Zero Effect (1998)</th>      <td>3.864407</td>      <td>3.723140</td>    </tr>    <tr>      <th>eXistenZ (1999)</th>      <td>3.098592</td>      <td>3.289086</td>    </tr>  </tbody></table><p>1216 rows Ã— 2 columns</p></div><p>æƒ³è¦æŸ¥çœ‹å¥³æ€§è§‚ä¼—å–œæ¬¢çš„ç”µå½±ï¼Œå¯ä»¥æŒ‰Fåˆ—è¿›è¡Œé™åºæ“ä½œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">top_female_ratings = mean_ratings.sort_values(by=<span class="string">&#x27;F&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">top_female_ratings[:<span class="number">10</span>]</span><br></pre></td></tr></table></figure><div><style scoped>    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre><code>.dataframe tbody tr th &#123;    vertical-align: top;&#125;.dataframe thead th &#123;    text-align: right;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>gender</th>      <th>F</th>      <th>M</th>    </tr>    <tr>      <th>title</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Close Shave, A (1995)</th>      <td>4.644444</td>      <td>4.473795</td>    </tr>    <tr>      <th>Wrong Trousers, The (1993)</th>      <td>4.588235</td>      <td>4.478261</td>    </tr>    <tr>      <th>Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)</th>      <td>4.572650</td>      <td>4.464589</td>    </tr>    <tr>      <th>Wallace &amp; Gromit: The Best of Aardman Animation (1996)</th>      <td>4.563107</td>      <td>4.385075</td>    </tr>    <tr>      <th>Schindler's List (1993)</th>      <td>4.562602</td>      <td>4.491415</td>    </tr>    <tr>      <th>Shawshank Redemption, The (1994)</th>      <td>4.539075</td>      <td>4.560625</td>    </tr>    <tr>      <th>Grand Day Out, A (1992)</th>      <td>4.537879</td>      <td>4.293255</td>    </tr>    <tr>      <th>To Kill a Mockingbird (1962)</th>      <td>4.536667</td>      <td>4.372611</td>    </tr>    <tr>      <th>Creature Comforts (1990)</th>      <td>4.513889</td>      <td>4.272277</td>    </tr>    <tr>      <th>Usual Suspects, The (1995)</th>      <td>4.513317</td>      <td>4.518248</td>    </tr>  </tbody></table></div><p>ç»Ÿè®¡å–œå‰§ç±»å‹ç”µå½±çš„ç”·å¥³äººæ•°åˆ†å¸ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">movies_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/movies.dat&#x27;</span></span><br><span class="line">ratings_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/ratings.dat&#x27;</span></span><br><span class="line">users_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/users.dat&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–è¯„åˆ†æ•°æ®é›†ï¼ŒæŒ‡å®šåˆ†éš”ç¬¦ä¸º::ï¼Œç¼–ç ä¸ºISO-8859-1</span></span><br><span class="line">rnames = [<span class="string">&#x27;userId&#x27;</span>, <span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;rating&#x27;</span>, <span class="string">&#x27;timestamp&#x27;</span>]</span><br><span class="line">ratings = pd.read_csv(ratings_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=rnames, engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–ç”¨æˆ·æ•°æ®é›†ï¼ŒæŒ‡å®šåˆ†éš”ç¬¦ä¸º::ï¼Œç¼–ç ä¸ºISO-8859-1</span></span><br><span class="line">unames = [<span class="string">&#x27;user_id&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;occupation&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>]</span><br><span class="line">users = pd.read_csv(users_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=unames, engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–ç”µå½±æ•°æ®é›†ï¼ŒæŒ‡å®šåˆ†éš”ç¬¦ä¸º::ï¼Œç¼–ç ä¸ºISO-8859-1</span></span><br><span class="line">movies = pd.read_csv(movies_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=[<span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;genres&#x27;</span>], engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­›é€‰å‡ºç±»å‹ä¸ºå–œå‰§çš„ç”µå½±</span></span><br><span class="line">comedy_movies = movies[movies[<span class="string">&#x27;genres&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;comedy&#x27;</span>, na=<span class="literal">False</span>, <span class="keyword">case</span>=<span class="literal">False</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®å–œå‰§ç”µå½±çš„IDç­›é€‰å‡ºè¯„åˆ†æ•°æ®</span></span><br><span class="line">comedy_ratings = ratings[ratings[<span class="string">&#x27;movieId&#x27;</span>].isin(comedy_movies[<span class="string">&#x27;movieId&#x27;</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶ç”¨æˆ·æ•°æ®å’Œå–œå‰§ç”µå½±è¯„åˆ†æ•°æ®ï¼Œç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„åˆ—å</span></span><br><span class="line">comedy_ratings_with_users = pd.merge(comedy_ratings, users, left_on=<span class="string">&#x27;userId&#x27;</span>, right_on=<span class="string">&#x27;user_id&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡è§‚çœ‹å–œå‰§ç”µå½±çš„ç”¨æˆ·æ€§åˆ«åˆ†å¸ƒ</span></span><br><span class="line">gender_distribution = comedy_ratings_with_users[<span class="string">&#x27;gender&#x27;</span>].value_counts()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–æ€§åˆ«åˆ†å¸ƒ</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))  <span class="comment"># è®¾ç½®å›¾è¡¨å¤§å°</span></span><br><span class="line">bar_colors = [<span class="string">&#x27;#1f77b4&#x27;</span>, <span class="string">&#x27;#ff7f0e&#x27;</span>]  <span class="comment"># è®¾ç½®æŸ±çŠ¶å›¾çš„é¢œè‰²</span></span><br><span class="line">plt.bar(gender_distribution.index, gender_distribution.values, color=bar_colors)</span><br><span class="line">plt.title(<span class="string">&#x27;Gender Distribution of Users Rating Comedy Movies&#x27;</span>, fontsize=<span class="number">16</span>)  <span class="comment"># è®¾ç½®æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;Gender&#x27;</span>, fontsize=<span class="number">12</span>)  <span class="comment"># è®¾ç½®xè½´æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Number of Users&#x27;</span>, fontsize=<span class="number">12</span>)  <span class="comment"># è®¾ç½®yè½´æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.xticks(gender_distribution.index, [<span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>], rotation=<span class="number">0</span>)  <span class="comment"># è®¾ç½®xè½´æ ‡ç­¾å¹¶é˜²æ­¢æ—‹è½¬</span></span><br><span class="line">plt.grid(axis=<span class="string">&#x27;y&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>)  <span class="comment"># æ·»åŠ yè½´ç½‘æ ¼çº¿ï¼Œè®¾ç½®æ ·å¼å’Œé€æ˜åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾è¡¨</span></span><br><span class="line">plt.tight_layout()  <span class="comment"># è‡ªåŠ¨è°ƒæ•´å­å›¾å‚æ•°ï¼Œä½¿ä¹‹å¡«å……æ•´ä¸ªå›¾è¡¨åŒºåŸŸ</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>â€‹<br><img src="https://file.imgcc.cloud/images/2024/08/13/a8db55b5f0e83a814ecf21b665182ba4.png" alt="output 36 0"><br>â€‹</p><p>ç»Ÿè®¡è§‚çœ‹å–œå‰§ç”µå½±çš„ç”¨æˆ·å¹´é¾„åˆ†å¸ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»Ÿè®¡è§‚çœ‹å–œå‰§ç”µå½±çš„ç”¨æˆ·å¹´é¾„åˆ†å¸ƒ</span></span><br><span class="line"><span class="comment"># ç”±äºå¹´é¾„æ•°æ®æ˜¯ç¦»æ•£çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡æ•°</span></span><br><span class="line">age_distribution = comedy_ratings_with_users[<span class="string">&#x27;age&#x27;</span>].value_counts().sort_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–å¹´é¾„åˆ†å¸ƒ</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))  <span class="comment"># è®¾ç½®å›¾è¡¨å¤§å°</span></span><br><span class="line">plt.bar(age_distribution.index, age_distribution.values, color=<span class="string">&#x27;skyblue&#x27;</span>)  <span class="comment"># ä½¿ç”¨å•ä¸€é¢œè‰²</span></span><br><span class="line">plt.title(<span class="string">&#x27;Age Distribution of Users Rating Comedy Movies&#x27;</span>, fontsize=<span class="number">16</span>)  <span class="comment"># è®¾ç½®æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;Age&#x27;</span>, fontsize=<span class="number">12</span>)  <span class="comment"># è®¾ç½®xè½´æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Number of Users&#x27;</span>, fontsize=<span class="number">12</span>)  <span class="comment"># è®¾ç½®yè½´æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.xticks(age_distribution.index, age_distribution.index)  <span class="comment"># è®¾ç½®xè½´æ ‡ç­¾</span></span><br><span class="line">plt.grid(axis=<span class="string">&#x27;y&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>)  <span class="comment"># æ·»åŠ yè½´ç½‘æ ¼çº¿ï¼Œè®¾ç½®æ ·å¼å’Œé€æ˜åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾è¡¨</span></span><br><span class="line">plt.tight_layout()  <span class="comment"># è‡ªåŠ¨è°ƒæ•´å­å›¾å‚æ•°ï¼Œä½¿ä¹‹å¡«å……æ•´ä¸ªå›¾è¡¨åŒºåŸŸ</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>â€‹<br><img src="https://file.imgcc.cloud/images/2024/08/13/8fd311ae43f6ab7c6945096f473c272e.png" alt="output 38 0"><br>â€‹</p><p>ç»Ÿè®¡è§‚çœ‹å–œå‰§ç±»å‹ç”µå½±çš„25å²ç”¨æˆ·çš„èŒä¸šåˆ†å¸ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">movies_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/movies.dat&#x27;</span></span><br><span class="line">ratings_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/ratings.dat&#x27;</span></span><br><span class="line">users_file = <span class="string">&#x27;C:/Users/28696/Desktop/äººå·¥æ™ºèƒ½/ml-1m/users.dat&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ•°æ®é›†</span></span><br><span class="line">rnames = [<span class="string">&#x27;userId&#x27;</span>, <span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;rating&#x27;</span>, <span class="string">&#x27;timestamp&#x27;</span>]</span><br><span class="line">ratings = pd.read_csv(ratings_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=rnames, engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">unames = [<span class="string">&#x27;user_id&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;occupation&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>]</span><br><span class="line">users = pd.read_csv(users_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=unames, engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">movies = pd.read_csv(movies_file, sep=<span class="string">&#x27;::&#x27;</span>, header=<span class="literal">None</span>, names=[<span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;genres&#x27;</span>], engine=<span class="string">&#x27;python&#x27;</span>, encoding=<span class="string">&#x27;ISO-8859-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­›é€‰å‡ºç±»å‹ä¸ºå–œå‰§çš„ç”µå½±</span></span><br><span class="line">comedy_movies = movies[movies[<span class="string">&#x27;genres&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;comedy&#x27;</span>, na=<span class="literal">False</span>, <span class="keyword">case</span>=<span class="literal">False</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®å–œå‰§ç”µå½±çš„IDç­›é€‰å‡ºè¯„åˆ†æ•°æ®</span></span><br><span class="line">comedy_ratings = ratings[ratings[<span class="string">&#x27;movieId&#x27;</span>].isin(comedy_movies[<span class="string">&#x27;movieId&#x27;</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶ç”¨æˆ·æ•°æ®å’Œå–œå‰§ç”µå½±è¯„åˆ†æ•°æ®</span></span><br><span class="line">comedy_ratings_with_users = pd.merge(comedy_ratings, users, left_on=<span class="string">&#x27;userId&#x27;</span>, right_on=<span class="string">&#x27;user_id&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­›é€‰å‡º25å²ç”¨æˆ·è§‚çœ‹çš„å–œå‰§ç”µå½±è¯„åˆ†</span></span><br><span class="line">age_25_comedy_ratings = comedy_ratings_with_users[(comedy_ratings_with_users[<span class="string">&#x27;age&#x27;</span>] == <span class="number">25</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡25å²ç”¨æˆ·çš„èŒä¸šåˆ†å¸ƒ</span></span><br><span class="line">occupation_distribution = age_25_comedy_ratings[<span class="string">&#x27;occupation&#x27;</span>].value_counts()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–èŒä¸šåˆ†å¸ƒ</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))  <span class="comment"># è®¾ç½®å›¾è¡¨å¤§å°</span></span><br><span class="line">plt.bar(occupation_distribution.index, occupation_distribution.values, color=<span class="string">&#x27;skyblue&#x27;</span>, edgecolor=<span class="string">&#x27;black&#x27;</span>, width=<span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&#x27;Occupation Distribution of 25-year-olds Rating Comedy Movies&#x27;</span>, fontsize=<span class="number">16</span>)  <span class="comment"># è®¾ç½®æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;Occupation&#x27;</span>, fontsize=<span class="number">12</span>)  <span class="comment"># è®¾ç½®xè½´æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;Number of Users&#x27;</span>, fontsize=<span class="number">12</span>)  <span class="comment"># è®¾ç½®yè½´æ ‡é¢˜å’Œå­—ä½“å¤§å°</span></span><br><span class="line">plt.xticks(occupation_distribution.index, rotation=<span class="number">45</span>)  <span class="comment"># æ—‹è½¬xè½´æ ‡ç­¾ï¼Œä½¿å…¶æ›´åŠ æ¸…æ™°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ç½‘æ ¼çº¿ï¼Œæé«˜å¯è¯»æ€§</span></span><br><span class="line">plt.grid(axis=<span class="string">&#x27;y&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨è°ƒæ•´å­å›¾å‚æ•°ï¼Œä½¿ä¹‹å¡«å……æ•´ä¸ªå›¾è¡¨åŒºåŸŸ</span></span><br><span class="line">plt.tight_layout()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾è¡¨</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>â€‹<br><img src="https://file.imgcc.cloud/images/2024/08/13/1c818ef0e33400f1c9f8f881167085af.png" alt="output 40 0"><br>â€‹</p><p>1ã€å¹´é¾„åˆ†ç»„ï¼šä½¿ç”¨ pandas.cut å‡½æ•°å°† users æ•°æ®é›†ä¸­çš„ç”¨æˆ·å¹´é¾„åˆ†ä¸ºä¸åŒçš„ç»„ã€‚</p><p>2ã€å¹´é¾„æ®µè¯„åˆ†ç»Ÿè®¡ï¼šä½¿ç”¨ ratings æ•°æ®é›†ï¼ŒæŒ‰ç…§ç”¨æˆ·å¹´é¾„åˆ†ç»„ç»Ÿè®¡æ¯ä¸ªå¹´é¾„æ®µçš„ç”¨æˆ·æ•°é‡å’Œå¹³å‡è¯„åˆ†ã€‚</p><p>3ã€è¢«è¯„ä»·æ¬¡æ•°æœ€å¤šçš„ç”µå½±ï¼šä½¿ç”¨ ratings æ•°æ®é›†æ‰¾å‡ºè¢«è¯„ä»·æ¬¡æ•°æœ€å¤šçš„50éƒ¨ç”µå½±ã€‚</p><p>4ã€å¹´é¾„æ®µè¯„åˆ†å·®å¼‚ï¼šå¯¹è¿™äº›ç”µå½±åœ¨ä¸åŒå¹´é¾„æ®µçš„å¹³å‡è¯„åˆ†è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾ users å’Œ ratings æ˜¯å·²ç»åŠ è½½çš„ç”¨æˆ·å’Œè¯„åˆ†æ•°æ®é›†</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨pandas.cutå‡½æ•°å°†ç”¨æˆ·å¹´é¾„åˆ†ç»„</span></span><br><span class="line">labels = [<span class="string">&#x27;0-9&#x27;</span>, <span class="string">&#x27;10-19&#x27;</span>, <span class="string">&#x27;20-29&#x27;</span>, <span class="string">&#x27;30-39&#x27;</span>, <span class="string">&#x27;40-49&#x27;</span>, <span class="string">&#x27;50-59&#x27;</span>, <span class="string">&#x27;60-69&#x27;</span>, <span class="string">&#x27;70-79&#x27;</span>]</span><br><span class="line">users[<span class="string">&#x27;age_group&#x27;</span>] = pd.cut(users.age, bins=<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">81</span>, <span class="number">10</span>), labels=labels)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶ç”¨æˆ·æ•°æ®å’Œè¯„åˆ†æ•°æ®é›†æ—¶ä½¿ç”¨æ­£ç¡®çš„åˆ—å</span></span><br><span class="line">ratings_with_users = pd.merge(ratings, users[[<span class="string">&#x27;user_id&#x27;</span>, <span class="string">&#x27;age_group&#x27;</span>]], left_on=<span class="string">&#x27;userId&#x27;</span>, right_on=<span class="string">&#x27;user_id&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯ä¸ªå¹´é¾„æ®µç”¨æˆ·è¯„åˆ†äººæ•°å’Œæ‰“åˆ†åå¥½</span></span><br><span class="line">age_rating_stats = ratings_with_users.groupby(<span class="string">&#x27;age_group&#x27;</span>)[<span class="string">&#x27;rating&#x27;</span>].agg([np.size, np.mean])</span><br><span class="line"><span class="built_in">print</span>(age_rating_stats)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾è¢«è¯„ä»·è¿‡æœ€å¤šæ¬¡çš„50éƒ¨ç”µå½±</span></span><br><span class="line">top_rated_movies = ratings_with_users[<span class="string">&#x27;movieId&#x27;</span>].value_counts().head(<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿™äº›ç”µå½±åœ¨ä¸åŒå¹´é¾„æ®µä¹‹é—´çš„æ‰“åˆ†å·®å¼‚</span></span><br><span class="line">rating_diff_by_age = ratings_with_users[ratings_with_users[<span class="string">&#x27;movieId&#x27;</span>].isin(top_rated_movies.index)].groupby([<span class="string">&#x27;age_group&#x27;</span>, <span class="string">&#x27;movieId&#x27;</span>])[<span class="string">&#x27;rating&#x27;</span>].mean().reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨unstackå‡½æ•°å°†æ•°æ®è½¬æ¢ä¸ºä¸€ä¸ªè¡¨æ ¼</span></span><br><span class="line">rating_diff_unstacked = rating_diff_by_age.pivot_table(index=<span class="string">&#x27;movieId&#x27;</span>, columns=<span class="string">&#x27;age_group&#x27;</span>, values=<span class="string">&#x27;rating&#x27;</span>, fill_value=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(rating_diff_unstacked.head(<span class="number">50</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–æŸéƒ¨ç”µå½±åœ¨ä¸åŒå¹´é¾„æ®µçš„è¯„åˆ†åˆ†å¸ƒ</span></span><br><span class="line">example_movie_id = ratings_with_users[ratings_with_users[<span class="string">&#x27;movieId&#x27;</span>].isin(top_rated_movies.index)][<span class="string">&#x27;movieId&#x27;</span>].iloc[<span class="number">0</span>]</span><br><span class="line">example_movie_ratings = rating_diff_by_age[rating_diff_by_age[<span class="string">&#x27;movieId&#x27;</span>] == example_movie_id]</span><br><span class="line">plt.bar(example_movie_ratings[<span class="string">&#x27;age_group&#x27;</span>], example_movie_ratings[<span class="string">&#x27;rating&#x27;</span>], color=<span class="string">&#x27;skyblue&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">f&quot;Average Rating of Movie <span class="subst">&#123;example_movie_id&#125;</span> by Age Group&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Average Rating&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Age Group&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>             size      meanage_group                  0-9         27211  3.54952010-19      183536  3.50757320-29      395556  3.54523530-39      199003  3.61816240-49      156123  3.67355950-59       38780  3.76663260-69           0       NaN70-79           0       NaNage_group       0-9     10-19     20-29     30-39     40-49     50-59movieId                                                              1          3.919643  4.017857  4.201266  4.302600  4.099602  3.88679234         3.325843  3.609929  3.957813  4.023684  4.007067  3.94805250         4.424242  4.680798  4.552430  4.390879  4.291866  4.431373110        4.192982  4.406250  4.254292  4.152318  4.108635  3.969388260        4.267327  4.427046  4.572695  4.354633  4.421397  4.250000...             ...       ...       ...       ...       ...       ...2916       3.441176  3.605978  3.651054  3.737500  3.820069  3.7058822987       3.888889  3.716578  3.638607  3.685552  3.695817  3.6666672997       4.090909  4.202083  4.091703  4.156171  4.064407  4.1494253175       3.739130  3.656357  3.764253  3.830380  3.815094  3.8644073578       4.203390  4.231441  4.084291  3.981651  4.147186  3.878788[50 rows x 6 columns]</code></pre><p><img src="https://file.imgcc.cloud/images/2024/08/13/e72455dc7d1f44e8391e8d1ecfb0fdb9.png" alt="output 45 1"></p><h1>1 Measuring Rating Disagreementï¼ˆè®¡ç®—è¯„åˆ†åˆ†æ­§ï¼‰</h1><p>å‡è®¾æˆ‘ä»¬æƒ³è¦æ‰¾å‡ºç”·æ€§å’Œå¥³æ€§è§‚ä¼—åˆ†æ­§æœ€å¤§çš„ç”µå½±ã€‚ä¸€ä¸ªåŠæ³•æ˜¯ç»™mean_ratingsåŠ ä¸Šä¸€ä¸ªç”¨äºå­˜æ”¾å¹³å‡å¾—åˆ†ä¹‹å·®çš„åˆ—ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ’åºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mean_ratings[<span class="string">&#x27;diff&#x27;</span>] = mean_ratings[<span class="string">&#x27;M&#x27;</span>] - mean_ratings[<span class="string">&#x27;F&#x27;</span>]</span><br></pre></td></tr></table></figure><p>æŒ‰â€˜diffâ€™æ’åºå³å¯å¾—åˆ°åˆ†æ­§æœ€å¤§ä¸”å¥³æ€§è§‚ä¼—æ›´å–œæ¬¢çš„ç”µå½±ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sorted_by_diff = mean_ratings.sort_values(by=<span class="string">&#x27;diff&#x27;</span>)</span><br><span class="line">sorted_by_diff[:<span class="number">15</span>]</span><br></pre></td></tr></table></figure><div><style>    .dataframe thead tr:only-child th {        text-align: right;    }<pre><code>.dataframe thead th &#123;    text-align: left;&#125;.dataframe tbody tr th &#123;    vertical-align: top;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>gender</th>      <th>F</th>      <th>M</th>      <th>diff</th>    </tr>    <tr>      <th>title</th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Dirty Dancing (1987)</th>      <td>3.790378</td>      <td>2.959596</td>      <td>-0.830782</td>    </tr>    <tr>      <th>Jumpin' Jack Flash (1986)</th>      <td>3.254717</td>      <td>2.578358</td>      <td>-0.676359</td>    </tr>    <tr>      <th>Grease (1978)</th>      <td>3.975265</td>      <td>3.367041</td>      <td>-0.608224</td>    </tr>    <tr>      <th>Little Women (1994)</th>      <td>3.870588</td>      <td>3.321739</td>      <td>-0.548849</td>    </tr>    <tr>      <th>Steel Magnolias (1989)</th>      <td>3.901734</td>      <td>3.365957</td>      <td>-0.535777</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>French Kiss (1995)</th>      <td>3.535714</td>      <td>3.056962</td>      <td>-0.478752</td>    </tr>    <tr>      <th>Little Shop of Horrors, The (1960)</th>      <td>3.650000</td>      <td>3.179688</td>      <td>-0.470312</td>    </tr>    <tr>      <th>Guys and Dolls (1955)</th>      <td>4.051724</td>      <td>3.583333</td>      <td>-0.468391</td>    </tr>    <tr>      <th>Mary Poppins (1964)</th>      <td>4.197740</td>      <td>3.730594</td>      <td>-0.467147</td>    </tr>    <tr>      <th>Patch Adams (1998)</th>      <td>3.473282</td>      <td>3.008746</td>      <td>-0.464536</td>    </tr>  </tbody></table><p>15 rows Ã— 3 columns</p></div><p>å¯¹è¡Œè¿›è¡Œååºæ“ä½œï¼Œå¹¶å–å‡ºå‰15è¡Œï¼Œå¾—åˆ°çš„åˆ™æ˜¯ç”·æ€§æ›´å–œæ¬¢ï¼Œè€Œå¥³æ€§è¯„ä»·è¾ƒä½çš„ç”µå½±ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reverse order of rows, take first 10 rows</span></span><br><span class="line">sorted_by_diff[::-<span class="number">1</span>][:<span class="number">10</span>]</span><br></pre></td></tr></table></figure><div><style>    .dataframe thead tr:only-child th {        text-align: right;    }<pre><code>.dataframe thead th &#123;    text-align: left;&#125;.dataframe tbody tr th &#123;    vertical-align: top;&#125;</code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>gender</th>      <th>F</th>      <th>M</th>      <th>diff</th>    </tr>    <tr>      <th>title</th>      <th></th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Good, The Bad and The Ugly, The (1966)</th>      <td>3.494949</td>      <td>4.221300</td>      <td>0.726351</td>    </tr>    <tr>      <th>Kentucky Fried Movie, The (1977)</th>      <td>2.878788</td>      <td>3.555147</td>      <td>0.676359</td>    </tr>    <tr>      <th>Dumb &amp; Dumber (1994)</th>      <td>2.697987</td>      <td>3.336595</td>      <td>0.638608</td>    </tr>    <tr>      <th>Longest Day, The (1962)</th>      <td>3.411765</td>      <td>4.031447</td>      <td>0.619682</td>    </tr>    <tr>      <th>Cable Guy, The (1996)</th>      <td>2.250000</td>      <td>2.863787</td>      <td>0.613787</td>    </tr>    <tr>      <th>Evil Dead II (Dead By Dawn) (1987)</th>      <td>3.297297</td>      <td>3.909283</td>      <td>0.611985</td>    </tr>    <tr>      <th>Hidden, The (1987)</th>      <td>3.137931</td>      <td>3.745098</td>      <td>0.607167</td>    </tr>    <tr>      <th>Rocky III (1982)</th>      <td>2.361702</td>      <td>2.943503</td>      <td>0.581801</td>    </tr>    <tr>      <th>Caddyshack (1980)</th>      <td>3.396135</td>      <td>3.969737</td>      <td>0.573602</td>    </tr>    <tr>      <th>For a Few Dollars More (1965)</th>      <td>3.409091</td>      <td>3.953795</td>      <td>0.544704</td>    </tr>  </tbody></table></div><p>å¦‚æœåªæ˜¯æƒ³è¦æ‰¾å‡ºåˆ†æ­§æœ€å¤§çš„ç”µå½±ï¼ˆä¸è€ƒè™‘æ€§åˆ«å› ç´ ï¼‰ï¼Œåˆ™å¯ä»¥è®¡ç®—å¾—åˆ†æ•°æ®çš„æ–¹å·®æˆ–æ ‡å‡†å·®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®ç”µå½±åç§°åˆ†ç»„çš„å¾—åˆ†æ•°æ®çš„æ ‡å‡†å·®</span></span><br><span class="line">rating_std_by_title = data.groupby(<span class="string">&#x27;title&#x27;</span>)[<span class="string">&#x27;rating&#x27;</span>].std()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®active_titlesè¿›è¡Œè¿‡æ»¤</span></span><br><span class="line">rating_std_by_title = rating_std_by_title.loc[active_titles]</span><br></pre></td></tr></table></figure><p>ä¸åŒæ€§åˆ«é—´äº‰è®®æœ€å¤§çš„ç”µå½±</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">movies_file = <span class="string">&quot;C:\\Users\\28696\\Desktop\\äººå·¥æ™ºèƒ½\\ml-1m\\movies.dat&quot;</span></span><br><span class="line">ratings_file = <span class="string">&quot;C:\\Users\\28696\\Desktop\\äººå·¥æ™ºèƒ½\\ml-1m\\ratings.dat&quot;</span></span><br><span class="line">users_file = <span class="string">&quot;C:\\Users\\28696\\Desktop\\äººå·¥æ™ºèƒ½\\ml-1m\\users.dat&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ•°æ®é›†æ—¶æŒ‡å®šåˆ†éš”ç¬¦ã€åˆ—åå’Œç¼–ç </span></span><br><span class="line"><span class="comment"># æ­¤å¤„çœç•¥äº†åŠ è½½æ•°æ®é›†çš„ä»£ç ï¼Œå‡è®¾æ•°æ®é›†å·²æ­£ç¡®åŠ è½½</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶æ•°æ®é›†çš„ä»£ç ä¿æŒä¸å˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡ç½®ç´¢å¼•å¹¶ä¿ç•™ movieId å’Œ title åˆ—</span></span><br><span class="line">lens.reset_index(inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé€è§†è¡¨ï¼Œä½¿ç”¨ &#x27;rating&#x27; å’Œ &#x27;gender&#x27; åˆ—</span></span><br><span class="line">pivoted = lens.pivot_table(index=[<span class="string">&#x27;movieId&#x27;</span>, <span class="string">&#x27;title&#x27;</span>], columns=<span class="string">&#x27;gender&#x27;</span>, values=<span class="string">&#x27;rating&#x27;</span>, fill_value=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ç”·å¥³è¯„åˆ†å·®å¼‚</span></span><br><span class="line">pivoted[<span class="string">&#x27;diff&#x27;</span>] = pivoted[<span class="string">&#x27;M&#x27;</span>] - pivoted[<span class="string">&#x27;F&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¾å‡ºè¯„åˆ†å·®å¼‚æœ€å¤§çš„50éƒ¨ç”µå½±çš„ç´¢å¼•</span></span><br><span class="line">most_50 = pivoted[<span class="string">&#x27;diff&#x27;</span>].<span class="built_in">abs</span>().sort_values(ascending=<span class="literal">False</span>).index[:<span class="number">50</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ¡å½¢å›¾ï¼Œè®¾ç½®é¢œè‰²ä¸ºæµ…è“è‰²</span></span><br><span class="line">disagreements = pivoted.loc[most_50, <span class="string">&#x27;diff&#x27;</span>]</span><br><span class="line">light_blue_color = <span class="string">&#x27;#ADD8E6&#x27;</span>  <span class="comment"># æµ…è“è‰²é¢œè‰²ä»£ç </span></span><br><span class="line">disagreements.sort_values().plot(kind=<span class="string">&#x27;barh&#x27;</span>, figsize=(<span class="number">12</span>, <span class="number">15</span>), color=light_blue_color)</span><br><span class="line">plt.title(<span class="string">&#x27;Male vs. Female Avg. Ratings\n(Difference &gt; 0 = Favored by Men)&#x27;</span>, fontsize=<span class="number">16</span>, fontweight=<span class="string">&#x27;bold&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Movie&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Average Rating Difference&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨è°ƒæ•´å­å›¾å‚æ•°ï¼Œä½¿ä¹‹å¡«å……æ•´ä¸ªå›¾è¡¨åŒºåŸŸ</span></span><br><span class="line">plt.tight_layout()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾è¡¨</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>â€‹<br><img src="https://file.imgcc.cloud/images/2024/08/13/ad930fbe6b40444b702caeb0faf67bd2.png" alt="output 56 0"><br>â€‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;MovieLens 1Mæ•°æ®é›†&lt;/h1&gt;
&lt;p&gt;è¿™ä¸ªæ•°æ®é›†æ˜¯ç”µå½±è¯„åˆ†æ•°æ®ï¼šåŒ…æ‹¬ç”µå½±è¯„åˆ†ï¼Œç”µå½±å…ƒæ•°æ®ï¼ˆé£æ ¼ç±»å‹ï¼Œå¹´ä»£ï¼‰ä»¥åŠå…³äºç”¨æˆ·çš„äººå£ç»Ÿè®¡å­¦æ•°æ®ï¼ˆå¹´é¾„ï¼Œé‚®ç¼–ï¼Œæ€§åˆ«ï¼ŒèŒä¸šç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;MovieLens 1Mæ•°æ®é›†è¯„åˆ†ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œç”µå½±ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;figure </summary>
      
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://ruikey.cn/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
  </entry>
  
  <entry>
    <title>RBMæ¨¡å‹ç ”è¯»ç¬”è®°</title>
    <link href="https://ruikey.cn/posts/cf0901bc.html"/>
    <id>https://ruikey.cn/posts/cf0901bc.html</id>
    <published>2024-08-11T10:19:15.000Z</published>
    <updated>2024-08-12T14:20:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è®ºæ–‡ç¬”è®°ï¼šRestricted-Boltzmann-Machines-for-Collaborative-Filtering">è®ºæ–‡ç¬”è®°ï¼šRestricted Boltzmann Machines for Collaborative Filtering</h2><p><strong>æ‘˜è¦</strong></p><p>ç›®å‰å­˜åœ¨çš„å¤§å¤šæ•°ååŒè¿‡æ»¤ç®—æ³•éƒ½ä¸èƒ½è§£å†³å¤§é‡æ•°æ®é›†å¯¹åº”çš„çŸ©é˜µè¿ç®—ï¼Œæœ¬æ–‡ä¸­å±•ç¤ºäº†ä¸¤å±‚çš„æ— å‘å›¾æ¨¡å‹ï¼Œå³RBMï¼Œå¯ä»¥ç”¨æ¥å»ºæ¨¡è¡¨æ ¼æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è¯„çº§ã€‚æˆ‘ä»¬ç»™å‡ºäº†é«˜æ•ˆçš„ç®—æ³•ï¼Œè¯æ˜äº†å®ƒåœ¨å¾ˆå¤§çš„æ•°æ®é›†ä¸Šå¯ä»¥è¿è¡Œã€‚åŒæ—¶ï¼Œè¿˜è¯æ˜äº†å®ƒæ¯”SVDçš„æ€§èƒ½ç•¥å¥½ã€‚å½“RBMå’ŒSVDç»„åˆæ—¶ï¼Œå¯ä»¥è·å¾—6%çš„æ€§èƒ½æå‡ã€‚</p><p><strong>ç»ªè®º</strong></p><p>ååŒè¿‡æ»¤çš„ä¸€ä¸ªå¸¸ç”¨æ–¹æ³•æ˜¯çŸ©é˜µåˆ†è§£ã€‚å‡å¦‚ç”¨N<em>Mçš„çŸ©é˜µæ¥è¡¨ç¤ºNåç”¨æˆ·è¯„ä»·Mä¸ªç”µå½±ï¼Œé‚£ä¹ˆN</em>MçŸ©é˜µå¯ä»¥å†™ä¸ºN<em>Cçš„çŸ©é˜µå’ŒC</em>Mçš„çŸ©é˜µçš„ä¹˜ç§¯ï¼Œå…¶ä¸­å‰è€…æ˜¯ç”¨æˆ·çŸ©é˜µï¼Œåè€…æ˜¯ç”µå½±çŸ©é˜µï¼ŒCæ˜¯ä¸»é¢˜çš„ä¸ªæ•°ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸€è¿‡ç¨‹é€šè¿‡å¥‡å¼‚å€¼åˆ†è§£(SVD)æ¥å®Œæˆã€‚ä½†å¤§è§„æ¨¡çš„æ•°æ®é›†é€šå¸¸é¢ä¸´ç€çŸ©é˜µè¿‡äºç¨€ç–çš„é—®é¢˜ï¼Œè¿™ä½¿å¾—å¥‡å¼‚å€¼åˆ†è§£å˜å¾—å¾ˆéš¾è¿›è¡Œã€‚æœ¬æ–‡ä¸­æå‡ºäº†RBMçš„è§£æ³•ã€‚è€Œä¸”é€šè¿‡CD-ké‡‡æ ·ï¼Œå¯ä»¥ä½¿RBMç®—æ³•ç²¾ç¡®åˆé«˜æ•ˆã€‚</p><p><strong>å—é™ç»å°”å…¹æ›¼æœº(RBM)</strong></p><p>æˆ‘ä»¬è¦è®­ç»ƒçš„æ˜¯ä¸€ä¸ªRBMã€‚å‡å¦‚æ‰€æœ‰Nä¸ªç”¨æˆ·éƒ½è¯„ä»·äº†Mä¸ªç”µå½±ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠæ¯ä¸ªç”¨æˆ·çœ‹ä½œä¸€ä¸ªå•ç‹¬çš„è®­ç»ƒæ ·æœ¬ï¼Œç»å°”å…¹æ›¼æœºæœ‰Mä¸ªå¯è§†èŠ‚ç‚¹å’Œè‹¥å¹²éšè—èŠ‚ç‚¹ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯çŸ©é˜µæ˜¯ç¨€ç–çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬é€‰æ‹©ä¸å»å¡«å……è¿™ä¸ªç¼ºå¤±é¡¹ï¼Œæˆ‘ä»¬çº¯ç²¹æ˜¯å¿½ç•¥å®ƒä»¬ã€‚</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/d73919d7ffe0a91d46272d49ceafa572.png" alt="image"></p><p>ä¾ç„¶æ˜¯ç”¨æ¯ä¸ªç”¨æˆ·çš„è¯„åˆ†è®°å½•ä½œä¸ºä¸€ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œä½†æ˜¯æ³¨æ„ï¼Œå¯¹äºæ¯ä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘ä»¬åªå…³æ³¨ä»–æœ‰è¯„åˆ†çš„é‚£äº›é¡¹ã€‚æ— è®ºæ˜¯å‰å‘è¿˜æ˜¯åå‘ä¼ æ’­æˆ–è€…è®­ç»ƒï¼Œæˆ‘ä»¬éƒ½åªå…³æ³¨å»ºç«‹äº†è¿æ¥çš„è¿™äº›èŠ‚ç‚¹ã€‚</p><p><strong>2.1 æ¨¡å‹å»ºç«‹</strong></p><p>æ ¹æ®å‰é¢çš„è¡¨è¿°ï¼ŒVæ˜¯ä¸€ä¸ªK*mçš„çŸ©é˜µï¼Œå®ƒä»¥äºŒå…ƒçš„å½¢å¼è¡¨å¾äº†ç”¨æˆ·å¯¹ç”µå½±çš„è¯„åˆ†æƒ…å†µã€‚é¦–å…ˆæŠŠVçš„æ¯ä¸€åˆ—å»ºæ¨¡ä¸ºæ¡ä»¶å¤šé¡¹å¼åˆ†å¸ƒ(å…¶å®ä¹Ÿå°±æ˜¯å¯¹æ¯ä¸€ä¸ªç”µå½±çš„è¯„åˆ†å»ºæ¨¡)</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/6e8e83a658f62f4f2a22a9505d7b3069.png" alt="image"></p><p><img src="https://file.imgcc.cloud/images/2024/08/13/c26e218cd329141983b6b31b1b975678.png" alt="image"></p><p>ç„¶åæŠŠéšè—èŠ‚ç‚¹å»ºæ¨¡ä¸ºæ¡ä»¶ä¼¯åŠªåˆ©åˆ†å¸ƒ(æ ¹æ®æ–‡ä¸­çš„è¡¨è¿°ï¼Œjä¸ªéšè—èŠ‚ç‚¹åº”è¯¥ä»£è¡¨äº†jä¸ªä¸»é¢˜)</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/3242e8a714dd2906dc5adfdbbd84fda2.png" alt="image"></p><p><img src="https://file.imgcc.cloud/images/2024/08/13/3a4d242266569a19d9689dea1cc3aab5.png" alt="image">æ˜¯é€»è¾‘æ–¯è’‚å‡½æ•°<img src="https://file.imgcc.cloud/images/2024/08/13/b53cce46ac5c67c5834fefa0506c02d3.png" alt="image">æ˜¯ç”µå½±içš„ç‰¹å¾jå’Œç­‰çº§kä¹‹é—´çš„å¯¹ç§°äº¤äº’å‚æ•°ï¼Œ<img src="https://file.imgcc.cloud/images/2024/08/13/44ad57ba383da72813b6e0dc7752db31.png" alt="image">è¡¨ç¤ºç”µå½±iåœ¨åˆ†æ•°kä¸Šçš„åå€šï¼Œè€Œ<img src="https://file.imgcc.cloud/images/2024/08/13/4efb1d1a1a7bf825b3ea9bdb7101529a.png" alt="image">æ˜¯ç‰¹å¾jçš„åå€šã€‚<img src="https://file.imgcc.cloud/images/2024/08/13/e1ee2c7dcea7995d208c2271e160ecf1.png" alt="image">å¯ä»¥è¢«åˆå§‹åŒ–ä¸ºè¯„åˆ†çš„iå¹³å‡å€¼ã€‚</p><p>ä¸‹é¢ï¼Œæ ¹æ®RBMçš„ç›¸å…³çŸ¥è¯†ï¼Œå¯ä»¥å†™å‡ºæ¦‚ç‡å‡½æ•°</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/477e8cc8e275996ee4450f082b9e2880.png" alt="image"></p><p>ä»¥åŠèƒ½é‡å‡½æ•°</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/2a69ff9d8cef6d54a3699f15bdf15477.png" alt="image"></p><p>Zè¿™ä¸€é¡¹ï¼Œè®ºæ–‡é‡Œè¯´è¿™ä¸ªæ˜¯å½’ä¸€åŒ–å› å­ã€‚</p><p>è¿™é‡Œæˆ‘è§‰å¾—éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ ‡å‡†çš„RBMä¸­ï¼Œæ¯ä¸€ä¸ªå¯è§†èŠ‚ç‚¹å¯¹åº”çš„æ˜¯ä¸€ä¸ªæ•°ï¼Œè€Œè¿™é‡Œå¯¹åº”çš„æ˜¯ä¸€ä¸ªKç»´çš„å‘é‡ã€‚æ‰€ä»¥å¯¹åº”çš„ï¼ŒWæ˜¯ä¸€ä¸ªi<em>j</em>kçš„çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªm<em>kçš„çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ª1</em>jçš„å‘é‡ï¼Œè¿™æ˜¯å› ä¸ºéšè—èŠ‚ç‚¹æ˜¯ä¸€ç»´çš„ï¼›å’Œè™½ç„¶éƒ½å«bï¼Œä½†æ˜¯å¹¶ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚</p><p><strong>2.2 è®­ç»ƒ</strong></p><p>æ ¹æ®RBMçš„å…¬å¼ï¼Œå¾ˆå®¹æ˜“å¯ä»¥å¾—åˆ°</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/ec85f88383922533e06d01d4ebad2c40.png" alt="image"></p><p>å…¶ä¸­ï¼Œdataå’Œmodelåˆ†åˆ«ä»£è¡¨äº†æ•°æ®å’Œæ¨¡å‹é©±åŠ¨ä¸‹çš„ä¸¤ä¸ªå€¼çš„å†…ç§¯ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å½“ç„¶å°±æ˜¯è®©å†…ç§¯æœ€å°åŒ–ï¼Œè¿™ä¹Ÿæœ‰ç‚¹ç±»ä¼¼äºæå¤§ä¼¼ç„¶ä¼°è®¡ã€‚è¿™è¾¹ä½¿ç”¨äº†==å¯¹æ¯”æ•£åº¦æ–¹æ³•==</p><hr><p>æœ¬æ–‡çš„æ–¹æ³•ï¼Œæ˜¯åœ¨å¾—åˆ°RBMæ¨¡å‹ä¹‹åï¼Œç”¨ç”¨æˆ·çš„ç”µå½±è¯„åˆ†å‘é‡ä½œä¸ºè¾“å…¥å‘é‡ï¼Œç„¶åç”¨RBM reconstructç”¨æˆ·çš„è¾“å…¥å‘é‡ï¼ŒåŒ…æ‹¬é‚£äº›missing inputï¼ˆè¡¨ç¤ºç”¨æˆ·æ²¡çœ‹è¿‡çš„ç”µå½±ï¼‰ã€‚æ­¤æ—¶ï¼Œè¿™äº›missing inputçš„å€¼å°±æ˜¯è¡¨ç¤ºäº†ç”¨æˆ·å¯¹è¿™ä¸ªç”µå½±çš„å–œå¥½ç¨‹åº¦ã€‚ç”µå½±æœ‰kä¸ªè¯„åˆ†ï¼ŒRBM reconstruct å¯¹è¿™kä¸ªå€¼ï¼ˆæ‰€å¯¹åº”çš„èŠ‚ç‚¹ï¼‰éƒ½æœ‰è¾“å‡ºã€‚é€‰æ‹©ç”¨æˆ·å¯¹è¿™ä¸ªç”µå½±çš„é¢„æµ‹è¯„åˆ†å°±æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ol><li>é€‰æ‹©kä¸ªèŠ‚ç‚¹ä¸­RBMè¾“å‡ºæƒå€¼æœ€å¤§çš„é‚£ä¸ªèŠ‚ç‚¹ä½œä¸ºç”¨æˆ·å¯¹å½“å‰ç”µå½±çš„è¯„åˆ†ï¼›</li><li>å¯¹è¿™kä¸ªèŠ‚ç‚¹çš„æƒé‡åŠ æƒå¹³å‡ï¼Œå¹³å‡å€¼ç¦»kä¸ªæ•°å­—å“ªä¸ªæœ€è¿‘ï¼Œå°±æ˜¯è¯„åˆ†æ˜¯å¤šå°‘ã€‚åœ¨å®è·µä¸­ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</li></ol><hr><p>æˆ‘ä»¬è¾“å…¥ç”¨æˆ·ç›®å‰å·²ç»æœ‰çš„è¯„åˆ†ï¼Œå¯ä»¥ç®—å‡ºéšè—èŠ‚ç‚¹ï¼Œç„¶åå†ç”±éšè—èŠ‚ç‚¹åå‘å¯ä»¥ç®—å‡ºå…¨éƒ¨çš„å¯è§†èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¡«è¡¥äº†é‚£äº›ç¼ºå¤±çš„è¯„åˆ†ã€‚</p><p><strong>3.æ¡ä»¶RBM</strong></p><p>è¿™é‡Œæåˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨ä¸Šé¢è®­ç»ƒçš„æ—¶å€™ï¼Œæ˜¯ç›´æ¥å¿½ç•¥äº†æ²¡çœ‹è¿‡çš„é‚£äº›ç”µå½±ï¼Œè€Œæˆ‘ä»¬æ²¡æœ‰è¾“å…¥çš„èŠ‚ç‚¹ä¼šç¡®ç¡®å®å®åœ°å½±å“åˆ°è¾“å…¥å€¼ã€‚åœ¨æ•°æ®ä¸­ï¼Œæœ‰äº›ç”¨æˆ·å¯èƒ½çœ‹è¿‡ç”µå½±ï¼Œä½†æ˜¯æ²¡æœ‰è¯„åˆ†æ•°æ®ï¼Œå› ä¸ºæ²¡æœ‰è¯„åˆ†æˆ–è€…è¯„åˆ†è¢«å¼„ä¸¢äº†ï¼Œè¿™ç§æƒ…å†µæ˜¯å€¼å¾—æ³¨æ„çš„ã€‚</p><p>æ–‡ç« ä¸­ç»™å‡ºäº†ä¸€ä¸ªè§£å†³çš„æ€è·¯Conditional RBMï¼Œå®ƒå¯ä»¥åŠ å…¥ä¸€äº›å¤–éƒ¨æ•°æ®çš„å½±å“ï¼Œç„¶è€Œè¿™ä¸€ç« é‡Œå¹¶æ²¡æœ‰ç”¨è¿™ä¸ªæ€è·¯ã€‚è¿™ä¸€ç« é‡Œï¼Œå¯¹äºé‚£äº›çœ‹è¿‡ä½†æ˜¯æ²¡æœ‰è¯„åˆ†çš„æ¡ä¾‹ï¼Œç”¨ç”µå½±çš„base rateä½œä¸ºè¾“å…¥å€¼è¿›è¡Œäº†è®­ç»ƒï¼Œå¹¶è·å¾—äº†ä¸é”™çš„ç»“æœã€‚</p><p><strong>4.</strong> <strong>æ¡ä»¶åˆ†è§£RBM</strong></p><p>ä¸Šé¢çš„çŸ©é˜µè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯WçŸ©é˜µç»´åº¦è¿‡å¤§ã€‚è¿‡å¤§çš„çŸ©é˜µä¸€æ–¹é¢ä¼šå¯¼è‡´è®¡ç®—å›°éš¾ï¼Œå¦ä¸€æ–¹é¢ä¼šå¾ˆå®¹æ˜“äº§ç”Ÿä¸¥é‡çš„è¿‡æ‹Ÿåˆã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒçŸ©é˜µåˆ†è§£å¯ä»¥ä¸Šåœº</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/d91c3b71eaa472450c8ec17060d8d008.png" alt="image"></p><p><img src="https://file.imgcc.cloud/images/2024/08/13/901b7eaceb68597252703855c0d6e462.png" alt="image"></p><p>åˆ†è§£åçš„çŸ©é˜µå‚æ•°é‡å¤§å¤§å‡å°ï¼Œé€Ÿåº¦ä¹Ÿå¿«çš„å¤šã€‚</p><p><strong>5.</strong> <strong>å®éªŒç»“æœ</strong></p><p><strong>å‚æ•°è®¾ç½®</strong></p><p>éšç‰¹å¾æ•°ï¼š100</p><p>5çš„é™ç»´çŸ©é˜µä¸­éšç‰¹å¾æ•°500ï¼Œé™ç»´ä¹‹åC=30</p><p>Batch-sizeï¼š1000</p><p>è¿­ä»£æ¬¡æ•°ï¼š40-50</p><p>å­¦ä¹ ç‡ï¼š0.01</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/dc2d8b4d85f71cfbc809513377ff3d58.png" alt="image"></p><p>æ²¡æœ‰ç»™å‡ºbaselineï¼Œä½†åº”è¯¥æ˜¯å¾ˆå¥½çš„ã€‚</p><p><strong>6.å¥‡å¼‚å€¼åˆ†è§£</strong></p><p>å¥‡å¼‚å€¼åˆ†è§£çš„åŸç†ï¼Œä¸å†èµ˜è¿°ã€‚</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/f8bf17721248ff9a8476a41c6828452b.png" alt="image"></p><p>å¯ä»¥çœ‹å‡ºï¼ŒRBMçš„æ•ˆæœæ›´å¥½ï¼Œä¸è¿‡æ²¡æœ‰å¥½å¤ªå¤šã€‚</p><p>åœ¨å®éªŒä¸­ï¼ŒSVDç»è¿‡äº†ç²¾å¿ƒçš„è°ƒå‚ï¼Œä½†æ˜¯RBMè¿˜æœ‰å¾ˆå¤šå‚æ•°å¯ä»¥ä¼˜åŒ–ï¼Œæ¯”å¦‚å­¦ä¹ ç‡ï¼Œbatch-sizeç­‰ã€‚æ‰€ä»¥RBMæœ‰ç€æ›´å¤šçš„æ½œåŠ›ã€‚å¦å¤–ï¼ŒSVDå’ŒRBMçš„é”™è¯¯å¾ˆä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œæ¨¡å‹èåˆä¹Ÿä¼šè·å¾—ä¸é”™çš„ç»“æœã€‚</p><p>æ„Ÿè§‰æ€ä¹ˆè¯´å‘¢</p><p>1.å­¦ä¹ è‡ªåŠ¨ç¼–ç å™¨ï¼šæ„Ÿè§‰å°±æ˜¯æŠŠRBMå˜æˆäº†è‡ªç¼–ç å™¨ï¼Œä»è€ŒæŠŠéšæœºéšè—å‘é‡å˜æˆäº†å®æ•°å‘é‡ã€‚</p><p>2.å­¦ä¹ æ›´æ·±çš„ç”Ÿæˆæ¨¡å‹</p><p><strong>7.æˆ‘çš„æ€è€ƒ</strong></p><p>åªçœ‹æ‡‚äº†ä¸€ä¸ªå¤§æ¦‚çš„æ„æ€ã€‚RBMåœ¨è¿™é‡Œæˆ‘è§‰å¾—æ˜¯ç±»ä¼¼äºè‡ªç¼–ç å™¨çš„å­˜åœ¨ï¼Œæå–éšè—ç‰¹å¾ï¼Œç»™å‡ºå…¶ä»–çš„çŸ©é˜µè¯„åˆ†ã€‚è¿™å·§å¦™åœ°åˆ©ç”¨äº†ç”µå½±ä¸ç”µå½±ä¹‹é—´çš„å…³ç³»ï¼Œä½¿å¾—é¢„æµ‹å˜å¾—ç®€æ´é«˜æ•ˆã€‚å…¶å®æ„Ÿè§‰æŒºå¾®å¦™çš„ï¼Œå½“æ—¶çœ‹å…¶ä»–è®ºæ–‡çš„æ—¶å€™è„‘å­é‡Œçªç„¶å°±æœ‰è¿™ä¸ªæƒ³æ³•ï¼Œå†å²æ•°æ®ç¨€ç–æ€§ã€é•¿çŸ­æ—¶è®°å¿†ã€å†·å¯åŠ¨ï¼ˆç²—ç²’åº¦ä¸ªæ€§åŒ–æ¨èã€éšå¼ä¿¡æ¯åé¦ˆï¼‰æ—¶é—´æ€§é¢„æµ‹ã€å¤šæ€ç›¸äº’èåˆã€æ ‡ç­¾åŒ–ä¹‹é—´å…³ç³»è¿æ¥åšå‡ºæ¨èä¿¡æ¯é€šè·¯ï¼Œæœ€åå¦‚ä½•æ±‡æ€»ç»„åˆâ€¦â€¦ æ„Ÿè§‰ä¸æ­¢è¿™äº›ï¼Œæœ€è¿‘çœ‹çš„è¶Šå¤šè®ºæ–‡ æ½œæ„è¯†æ„Ÿè§‰å¥½å¤šä¸œè¥¿ä¸­é—´æœ‰ä¸ªä¸œè¥¿åœ¨è¿æ¥ç€å®ƒä»¬ éšéšåœ¨å¾€ä¸Šæ¨åœ¨å¯»æ‰¾ä¸€ä¸ªæœ€ä¼˜çš„å¹³è¡¡ç‚¹â€¦â€¦</p><p>é¡ºä¾¿ï¼Œè®²å¾—æ¯”è¾ƒå¥½çš„å‡ ä¸ªRBMçš„åŸç†åœ¨è¿™é‡Œ</p><p><a href="https://blog.csdn.net/Yt7589/article/details/52487505">https://blog.csdn.net/Yt7589/article/details/52487505</a></p><p><a href="https://blog.csdn.net/peghoty/article/details/19168937">https://blog.csdn.net/peghoty/article/details/19168937</a></p><p>å¤§ä½“æœ‰äº†æ„Ÿæ€§çš„è®¤è¯†ã€‚å¸Œæœ›ä»¥åçœ‹äº†æ–°çš„è®ºæ–‡ä¼šæœ‰ä¸€äº›æ›´æ·±å…¥çš„æ€è€ƒã€‚</p><p>æŠ€æœ¯æ€»ç»“ï¼š</p><p>1.å¯¹çŸ©é˜µçš„é™ç»´ã€‚ç¬¬äº”éƒ¨åˆ†ä¸­è®²è§£äº†å¦‚ä½•é€šè¿‡é™ç»´æ¥å¤§å¤§æå‡è¿è¡Œé€Ÿåº¦ï¼Œé™ç»´æ˜¯ä¸€ä¸ªéå¸¸ä¸‡èƒ½çš„æ–¹æ³•ï¼Œå¯ä»¥ç•™æ„ä¸€ä¸‹ã€‚</p><p>2.åŠ å…¥â€œçœ‹è¿‡ä½†æ˜¯æœªè¯„åˆ†çš„è®°å½•â€ï¼Œå……åˆ†åˆ©ç”¨ä¿¡æ¯ä¼˜åŒ–ç»“æœã€‚</p><p>3.åˆ©ç”¨diversityçš„ç‰¹æ€§æ¥åšæ¨¡å‹èåˆã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;è®ºæ–‡ç¬”è®°ï¼šRestricted-Boltzmann-Machines-for-Collaborative-Filtering&quot;&gt;è®ºæ–‡ç¬”è®°ï¼šRestricted Boltzmann Machines for Collaborative Filtering&lt;/h2&gt;
</summary>
      
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://ruikey.cn/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
  </entry>
  
  <entry>
    <title>NCFè®ºæ–‡ç ”è¯»ç¬”è®°</title>
    <link href="https://ruikey.cn/posts/153bfe0a.html"/>
    <id>https://ruikey.cn/posts/153bfe0a.html</id>
    <published>2024-08-11T10:19:10.000Z</published>
    <updated>2024-08-12T14:15:00.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="NCFè®ºæ–‡ç ”è¯»ç¬”è®°">NCFè®ºæ–‡ç ”è¯»ç¬”è®°</h3><p>éšç€è¿‘äº›å¹´æ¥æ·±åº¦å­¦ä¹ çš„å‘å±•ï¼Œåœ¨æ¨èç³»ç»Ÿæ–¹é¢ï¼Œè¶Šæ¥è¶Šå¤šçš„æ¨èæ¨¡å‹æ˜¯åŸºäºç¥ç»ç½‘ç»œæ¥è§£å†³æ¨èé—®é¢˜ï¼Œä½†è¿™äº›æ¨¡å‹ä¸»è¦ä½¿ç”¨å®ƒæ¥æ¨¡æ‹Ÿè¾…åŠ©ä¿¡æ¯ï¼Œä¾‹å¦‚é¡¹ç›®çš„æ–‡æœ¬æè¿°å’ŒéŸ³ä¹çš„å£°å­¦ç‰¹å¾ã€‚è€Œåœ¨å¯¹ååŒè¿‡æ»¤çš„å…³é”®å› ç´ â€”â€”ç”¨æˆ·å’Œé¡¹ç›®ç‰¹å¾ä¹‹é—´çš„äº¤äº’è¿›è¡Œå»ºæ¨¡æ—¶ï¼Œå¤§éƒ¨åˆ†å·¥ä½œä»ç„¶é‡‡ç”¨çŸ©é˜µåˆ†è§£ï¼ˆmatrix factorizationï¼‰ï¼Œå¹¶å¯¹ç”¨æˆ·å’Œé¡¹ç›®çš„æ½œåœ¨ç‰¹å¾åº”ç”¨å†…ç§¯(inner product)ã€‚ NCFæ¨¡å‹ä¸ä¼ ç»Ÿçš„çŸ©é˜µåˆ†è§£çš„ä¸åŒåœ¨äºï¼ŒNCFå¯¹åˆ†è§£ä¹‹åè·å¾—çš„éšå‘é‡ä¸å†æ˜¯ç®€å•åœ°è¿›è¡Œå†…ç§¯æ“ä½œï¼Œè€Œæ˜¯è€ƒè™‘æ›´ä¸ºå¤æ‚çš„å†…ç§¯å½¢å¼ï¼Œå¹¶åˆ©ç”¨å¤šå±‚æ„ŸçŸ¥æœºï¼Œå¯¹ç”¨æˆ·-ç‰©å“äº¤äº’ä¿¡æ¯è¿›è¡Œæ·±å…¥åœ°å­¦ä¹ ï¼Œä»è€Œè·å–æ›´å¥½çš„ç»“æœã€‚</p><h4 id="1-MFæ¨¡å‹">1. MFæ¨¡å‹</h4><p>MFæ¨¡å‹ï¼ˆçŸ©é˜µåˆ†è§£æ¨¡å‹ï¼‰çš„å®ç°æ€è·¯æ˜¯é€šè¿‡å¯¹ç”±nä¸ªç”¨æˆ·å’Œmä¸ªç‰©å“ç»„æˆçš„ç”¨æˆ·-ç‰©å“è¯„åˆ†çŸ©é˜µè¿›è¡Œåˆ†è§£ï¼Œå°†æ•´ä½“è¯„åˆ†çŸ©é˜µåˆ†è§£ä¸ºä¸¤ä¸ªçŸ©é˜µçš„ä¹˜ç§¯ï¼Œå…¶ä¸­ä¸€ä¸ªçŸ©é˜µçš„å¤§å°ä¸ºn<em>kï¼Œå¦ä¸€ä¸ªçŸ©é˜µçš„å¤§å°ä¸ºk</em>mï¼Œè¿™ä¸¤ä¸ªçŸ©é˜µä¸­çš„ç»´åº¦kè¡¨ç¤ºæ½œåœ¨ç©ºé—´ç»´åº¦ã€‚æ¥ç€å¯¹äºç¬¬iä¸ªç”¨æˆ·å¯¹ç¬¬jä¸ªç‰©å“çš„å–œçˆ±ç¨‹åº¦è¯„ä¼°é—®é¢˜ï¼Œå¯ä»¥åˆ©ç”¨ç¬¬ä¸€ä¸ªçŸ©é˜µä¸­çš„ç¬¬iä¸ªç”¨æˆ·çš„kç»´å‘é‡ä¸ç¬¬äºŒä¸ªçŸ©é˜µä¸­ç¬¬jä¸ªç‰©å“çš„kç»´å‘é‡è¿›è¡Œå†…ç§¯ï¼Œè®¡ç®—å¾—åˆ°å…·ä½“çš„å–œçˆ±ç¨‹åº¦ï¼š</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/4356cfef9f754f4073d67038a40490fe.png" alt="image"></p><p>å…¶ä¸­ï¼Œå‘é‡<strong>p</strong>uè¡¨ç¤ºç”¨æˆ·uçš„éšå‘é‡ï¼Œå‘é‡<strong>q</strong>iè¡¨ç¤ºç‰©å“içš„éšå‘é‡ã€‚ç„¶è€Œè¿™ç§æ–¹å¼ç”±äºä»…ä»…æ˜¯ç®€å•åœ°è¿›è¡Œçº¿æ€§å†…ç§¯æ“ä½œï¼Œå› æ­¤ï¼Œå­˜åœ¨ç€ä¸€å®šçš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼Œç°å‡è®¾å­˜åœ¨ç”¨æˆ·u1ï¼Œu2ï¼Œu3ï¼Œå…¶ä¸­u1ä¸u2å…·æœ‰è¾ƒé«˜çš„ç›¸ä¼¼åº¦ï¼Œåœ¨éšå‘é‡ç©ºé—´ä¸­è¡¨ç°ä¸ºå‘é‡é—´å¤¹è§’è¾ƒå°ï¼Œè€Œu1ä¸u3çš„ç›¸ä¼¼åº¦æ¯”è¾ƒä½ï¼Œåœ¨éšå‘é‡ç©ºé—´ä¸­è¡¨ç°ç»´å‘é‡é—´å¤¹è§’è¾ƒå¤§ï¼Œè¿™æ—¶ï¼Œå¦‚æœå‡ºç°ä¸€ä½æ–°çš„ç”¨æˆ·u4ï¼Œä¸”u4ä¸å…¶ä»–ä¸‰ä¸ªç”¨æˆ·çš„ç›¸ä¼¼åº¦ä»å¤§åˆ°å°æ’åºä¸ºu1ã€u3ã€u2ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å­˜ç°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æƒ…å†µï¼š</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/384a0eb9c624cc376ba9fd7455594eaa.png" alt="image"></p><p>(a)æ˜¯user-itemäº¤äº’çŸ©é˜µï¼Œ1(b)æ˜¯ç”¨æˆ·çš„éšå¼ç©ºé—´ï¼Œè®ºæ–‡ä¸­å¼ºè°ƒäº†ä¸¤ç‚¹æ¥ç†è§£è¿™å¼ å›¾ç‰‡ï¼š</p><p>1ï¼‰MFå°†userå’Œitemåˆ†å¸ƒåˆ°åŒæ ·çš„éšå¼ç©ºé—´ä¸­ï¼Œé‚£ä¹ˆä¸¤ä¸ªç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼æ€§ä¹Ÿå¯ä»¥ç”¨äºŒè€…åœ¨éšå¼ç©ºé—´ä¸­çš„å‘é‡å¤¹è§’æ¥ç¡®å®šã€‚</p><p>2ï¼‰ä½¿ç”¨Jaccardç³»æ•°ï¼ˆç”¨æˆ·äº¤äº’é¡¹ç›®é›† äº¤/å¹¶ï¼‰æ¥ä½œä¸ºçœŸå®çš„ç”¨æˆ·ç›¸ä¼¼æ€§ã€‚</p><p>å›¾ä¸­ï¼Œ<strong>p</strong>1ã€<strong>p</strong>2ã€<strong>p</strong>3å‘é‡æ˜¯åŸå…ˆå·² ç»ç¡®å®šçš„ï¼Œè€Œåœ¨è€ƒè™‘å¼•å…¥æ–°ç”¨æˆ·u4æ—¶ï¼Œæ— è®ºu4å¯¹åº”çš„éšå‘é‡ä½äºå“ªä¸€æ ¹è™šçº¿ï¼Œéƒ½æ— æ³•æ»¡è¶³u4å’Œu3ä¹‹é—´çš„ç›¸ä¼¼åº¦å¤§äºu4å’Œu2ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚è€Œä¸€ç§è§£å†³çš„æ–¹æ¡ˆæ˜¯å°†ç»´åº¦kå¢å¤§ï¼Œå³åˆ©ç”¨æ›´é«˜ç»´åº¦çš„ç©ºé—´æ¥è¡¨ç¤ºéšå‘é‡ï¼Œä½†æ˜¯è¿™ç§åšæ³•å¯èƒ½ä¼šå¯¹æ¨¡å‹çš„æ³›åŒ–äº§ç”Ÿä¸åˆ©å½±å“ï¼ˆä¾‹å¦‚ï¼Œè¿‡åº¦æ‹Ÿåˆæ•°æ®ï¼‰ï¼Œå°¤å…¶æ˜¯åœ¨ç¨€ç–è®¾ç½®ä¸­ï¼Œå› æ­¤ï¼Œæœ¬ç¯‡è®ºæ–‡é’ˆå¯¹è¿™ä¸€ç¼ºç‚¹ï¼Œå¯¹æ¨¡å‹çš„MFéƒ¨åˆ†è¿›è¡Œäº†æ”¹è¿›ï¼Œæå‡ºä¸€ç§åŸºäºNCFé€šç”¨ç»“æ„çš„GMFæ¨¡å‹ã€‚</p><h4 id="2-æ¨¡å‹é€šç”¨ç»“æ„">2.æ¨¡å‹é€šç”¨ç»“æ„</h4><p><img src="https://file.imgcc.cloud/images/2024/08/13/128c77aae4c3d0f863d2f581f39ab8c2.png" alt="image"></p><p>NCFçš„é€šç”¨è®¾è®¡ç»“æ„ã€‚é¦–å…ˆå°†ç”¨æˆ·å’Œç‰©å“åˆ†åˆ«ä½¿ç”¨one-hot encodingè¿›è¡Œè¡¨ç¤ºï¼Œæ¥ç€å°†ç»è¿‡one-hot encodingå¾—åˆ°çš„ç¨€ç–å‘é‡è¿›è¡Œembeddingæ“ä½œï¼Œè¡¨ç¤ºæˆä¸€ä¸ªkç»´ç©ºé—´ä¸­çš„ç¨ å¯†çŸ©é˜µï¼Œä¹‹åå°†ç”¨æˆ·éšå‘é‡å’Œç‰©å“éšå‘é‡è¿›è¡Œæ‹¼æ¥å¹¶è¾“å…¥åˆ°DNNç½‘ç»œä¸­ï¼Œç»è¿‡å¤šå±‚æ„ŸçŸ¥æœºåå­¦ä¹ å¾—åˆ°å¯¹åº”çš„å¾—åˆ†</p><h4 id="3-æ¨¡å‹å…·ä½“ç»“æ„">3.æ¨¡å‹å…·ä½“ç»“æ„</h4><p>é’ˆå¯¹è¿™ä¸ªé€šç”¨æ¡†æ¶ï¼Œè®ºæ–‡æå‡ºäº†ä¸‰ç§ä¸åŒçš„å®ç°ï¼Œä¸‰ç§å®ç°å¯ä»¥ç”¨ä¸€å¼ å›¾æ¥è¯´æ˜ï¼š</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/3141e8880060aeab1079ea2e097f3207.png" alt="image"></p><h5 id="GMFï¼ˆå¹¿ä¹‰çŸ©é˜µåˆ†è§£ï¼‰"><strong>GMFï¼ˆå¹¿ä¹‰çŸ©é˜µåˆ†è§£ï¼‰</strong></h5><p>è€ƒè™‘åˆ°MFæ¨¡å‹çš„ä¸€ä¸ªç¼ºç‚¹åœ¨äºMFä»…è€ƒè™‘äº†ç®€å•çº¿æ€§çš„å†…ç§¯æ“ä½œï¼Œåœ¨ä½ç»´è¡¨ç¤ºç©ºé—´ä¸­ï¼Œå®¹æ˜“å‡ºç°å‰æ–‡è®ºè¿°çš„é—®é¢˜ï¼Œå› æ­¤ï¼Œä¸€ç§è®¾è®¡æ€è·¯æ˜¯åœ¨MFçš„åŸºç¡€ä¸Šåšå‡ºäº†ä¸€å®šçš„æ”¹è¿›GMFå¯¹åº”çš„æ•°å­¦å…¬å¼å¦‚ä¸‹ï¼š</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/ff56d49a0a0e8a8335d4590301ca3a1b.png" alt="image"></p><p>GMFå°†å†…ç§¯æ“ä½œæ›¿æ¢æˆåŸå§‹é€ä½ä¹˜ç§¯ï¼Œä¸å†…ç§¯ä¸åŒï¼Œè¯¥æ“ä½œæ˜¯å°†ä¸¤ä¸ªå‘é‡çš„å¯¹åº”ä½ç½®å…ƒç´ è¿›è¡Œä¹˜ç§¯ï¼Œæœ€ç»ˆçš„ç»“æœä»ç„¶ä¸ºä¸€ä¸ªkç»´å‘é‡ï¼ŒåŒæ—¶ï¼ŒGMFç»™äºˆäº†é€ä½ä¹˜ç§¯å¯¹åº”çš„æƒé‡å‘é‡<strong>h</strong>ã€‚ä¸ºäº†ä½¿æ¨¡å‹æ›´å…·è¡¨ç°åŠ›ï¼ŒGMFåœ¨æ¨¡å‹ä¸­èå…¥äº†éçº¿æ€§æ“ä½œï¼Œåˆ©ç”¨Sigmoidå‡½æ•°ï¼ˆa_outï¼‰å¯¹èµ‹æƒåçš„å‘é‡è¿›è¡Œè®¡ç®—ã€‚</p><h5 id="MLPï¼ˆå¤šå±‚æ„ŸçŸ¥å™¨ï¼‰"><strong>MLPï¼ˆå¤šå±‚æ„ŸçŸ¥å™¨ï¼‰</strong></h5><p>ç”±äº NCF åˆ†åˆ«å¯¹ç”¨æˆ·å’Œç‰©å“è¿›è¡Œäº†éšè¡¨ç¤ºçš„å­¦ä¹ ï¼Œå› æ­¤ä¸€ç§æ¯”è¾ƒç›´è§‚çš„åšæ³•æ˜¯é€šè¿‡å°†ç‰©å“å’Œç”¨æˆ·çš„éšå‘é‡è¿›è¡Œç®€å•æ‹¼æ¥ï¼Œå†ç›´æ¥è¿›è¡Œäº¤äº’ä¼°è®¡ã€‚ä½†æ˜¯ï¼Œç®€å•çš„å‘é‡è¿æ¥å¹¶æ²¡æœ‰è€ƒè™‘åˆ°ç”¨æˆ·å’Œé¡¹ç›®æ½œåœ¨ç‰¹å¾ä¹‹é—´çš„ä»»ä½•äº¤äº’ï¼Œè¿™ä¸è¶³ä»¥æ¨¡æ‹Ÿåä½œè¿‡æ»¤æ•ˆæœã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬ç¯‡è®ºæ–‡å»ºè®®åœ¨concatä¸ŠÂ·æ·»åŠ éšè—å±‚ï¼Œä½¿ç”¨æ ‡å‡† MLP æ¥å­¦ä¹ ç”¨æˆ·å’Œé¡¹ç›®æ½œåœ¨ç‰¹å¾ä¹‹é—´çš„äº¤äº’ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼Œè¿™æ ·åšå¯ä»¥èµ‹äºˆæ¨¡å‹å¾ˆå¤§ç¨‹åº¦çš„çµæ´»æ€§å’Œéçº¿æ€§æ¥å­¦ä¹ éšå‘é‡ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œè€Œä¸æ˜¯åƒ GMF é‚£æ ·åªå¯¹å®ƒä»¬ä½¿ç”¨å›ºå®šçš„å…ƒç´ ä¹˜ç§¯ï¼Œå…·ä½“è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/01ebe70a647efe8c7856f7054f03920b.png" alt="image"></p><h5 id="GMFä¸MLPç»„åˆ-NeuMFï¼ˆç¥ç»çŸ©é˜µåˆ†è§£ï¼‰">GMFä¸MLPç»„åˆ-NeuMFï¼ˆç¥ç»çŸ©é˜µåˆ†è§£ï¼‰</h5><p>æœ¬ç¯‡è®ºæ–‡è®¤ä¸ºGMFæ¨¡å‹å¯ä»¥é€šè¿‡è®¾ç½®æ¿€æ´»å‡½æ•°Sigmoidå’Œæƒé‡å‘é‡æ¥è·å¾—éšå‘é‡çš„çº¿æ€§è¡¨ç¤ºï¼Œè€ŒMLPå¯ä»¥é€šè¿‡å¤šå±‚æ„ŸçŸ¥æœºæ¥å­¦ä¹ åˆ°éšå‘é‡çš„éçº¿æ€§è¡¨ç¤ºï¼Œå› æ­¤ï¼Œæœ¬ç¯‡è®ºæ–‡å¼€å§‹å°è¯•å¯¹ä¸¤ç§æ¨¡å‹è¿›è¡Œç»„åˆã€‚</p><p>1ï¼‰è®©ä¸¤ä¸ªæ¨¡å‹å…±äº«embeddingå±‚è·å¾—çš„éšå‘é‡</p><p>ä¼˜ï¼šä¸€å®šç¨‹åº¦é™ä½æ¨¡å‹å¤æ‚åº¦</p><p>åŠ£ï¼šå½±å“æ¨¡å‹è¡¨ç°ï¼ˆä¸¤ä¸ªæ¨¡å‹çš„éœ€è¦è®¾ç½®ç›¸åŒçš„éšè—ç©ºé—´ç»´åº¦ï¼Œè¿™æ ·ä¼šä½¿å¾—æ¨¡å‹çš„çµæ´»åº¦ä¸‹é™ä¸”å¯èƒ½æœ€ä½³éšè—ç©ºé—´ç»´åº¦å¯èƒ½ä¸ç›¸ç­‰ï¼‰</p><p>2)ç‹¬ç«‹å­¦ä¹ éšå‘é‡(ä¸¤ä¸ªæ¨¡å‹åˆ†åˆ«è®¾ç½®å•ç‹¬çš„Embeddingå±‚)è¡¨è¾¾å¦‚ä¸‹ï¼š</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/b8114691075e5c907648217e7ad32198.png" alt="image"></p><h4 id="4-æ¨¡å‹å®éªŒ">4 æ¨¡å‹å®éªŒ</h4><p>è®ºæ–‡é€šè¿‡ä¸‰ä¸ªè§’åº¦è¿›è¡Œäº†è¯•éªŒï¼š</p><p>RQ1 æˆ‘ä»¬æå‡ºçš„NCFæ–¹æ³•æ˜¯å¦èƒœè¿‡ state-of-the-art çš„éšæ€§ååŒè¿‡æ»¤æ–¹æ³•ï¼Ÿ</p><p>RQ2 æˆ‘ä»¬æå‡ºçš„ä¼˜åŒ–æ¡†æ¶ï¼ˆæ¶ˆææ ·æœ¬æŠ½æ ·çš„loglossï¼‰æ€æ ·ä¸ºæ¨èä»»åŠ¡æœåŠ¡ï¼Ÿ</p><p>RQ3 æ›´æ·±çš„éšè—å•å…ƒæ˜¯ä¸æ˜¯æœ‰åŠ©äºå¯¹ç”¨æˆ·é¡¹ç›®äº¤äº’æ•°æ®çš„å­¦ä¹ ï¼Ÿ</p><p>è¯„ä¼°æ–¹æ¡ˆï¼šè®ºæ–‡é‡‡ç”¨äº†leave-one-outæ–¹æ³•è¯„ä¼°</p><p>è®ºæ–‡å°†NCFæ–¹æ³•ä¸ä¸‹åˆ—æ–¹æ³•è¿›è¡Œäº†æ¯”è¾ƒï¼šItemPopï¼ŒItemKNNï¼ŒBPRï¼ŒeALS</p><h5 id="RQ1è¯•éªŒç»“æœ">RQ1è¯•éªŒç»“æœ</h5><p><img src="https://file.imgcc.cloud/images/2024/08/13/238ee4000205a001cb5d4503904d2a6a.png" alt="image"></p><p>å³NCFæ•ˆæœå¥½äºBaseLineæ¨¡å‹</p><h5 id="RQ2è¯•éªŒç»“æœ">RQ2è¯•éªŒç»“æœ</h5><p><img src="https://file.imgcc.cloud/images/2024/08/13/635f1b3ba2577f6881920bb4b49dd369.png" alt="image"></p><p>Figure 6 è¡¨ç¤ºå°†æ¨¡å‹çœ‹ä½œä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡å¹¶ä½¿ç”¨loglossä½œä¸ºæŸå¤±å‡½æ•°æ—¶çš„è®­ç»ƒæ•ˆæœã€‚</p><p>Figure7 è¡¨ç¤ºé‡‡æ ·ç‡å¯¹æ¨¡å‹æ€§èƒ½çš„å½±å“ï¼ˆæ¨ªè½´æ˜¯é‡‡æ ·ç‡ï¼Œå³è´Ÿæ ·æœ¬ä¸æ­£æ ·æœ¬çš„æ¯”ä¾‹ï¼‰ã€‚</p><p>æœ€ä½³é‡‡æ ·æ¯”çº¦ä¸º 3 åˆ° 6ï¼Œè¿‡äºæ¿€è¿›åœ°è®¾ç½®é‡‡æ ·ç‡å¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸åˆ©å½±å“</p><h5 id="RQ3è¯•éªŒç»“æœ">RQ3è¯•éªŒç»“æœ</h5><p><img src="https://file.imgcc.cloud/images/2024/08/13/17a40fc6fffc5486e2047a4794e690c4.png" alt="image"></p><p><img src="https://file.imgcc.cloud/images/2024/08/13/4ffb8544fcc10b06ee9ab6c8cc473d3f.png" alt="image"></p><p>ä¸Šé¢çš„è¡¨æ ¼è®¾ç½®äº†ä¸¤ä¸ªå˜é‡ï¼Œåˆ†åˆ«æ˜¯Embeddingçš„é•¿åº¦Kå’Œç¥ç»ç½‘ç»œçš„å±‚æ•°ï¼Œä½¿ç”¨ç±»ä¼¼ç½‘æ ¼æœç´¢çš„æ–¹å¼å±•ç¤ºäº†åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šçš„ç»“æœã€‚å¢åŠ Embeddingçš„é•¿åº¦å’Œç¥ç»ç½‘ç»œçš„å±‚æ•°æ˜¯å¯ä»¥æå‡è®­ç»ƒæ•ˆæœçš„ã€‚</p><p>TIPSæ€è€ƒï¼šæ¨¡å‹åœ¨è¾…åŠ©ä¿¡æ¯çš„ä½¿ç”¨æ–¹é¢ä»¥åŠä¿¡æ¯ç‰¹å¾æŠ½å–æ–¹é¢å­˜åœ¨ä¸è¶³ã€‚ç¥ç»ååŒè¿‡æ»¤æ¨¡å‹ä½¿ç”¨ç”¨æˆ·ä¸é¡¹ç›®å†å²è¡Œä¸ºä¿¡æ¯,ç”ŸæˆåµŒå…¥ç‰¹å¾,é€šè¿‡å¤šå±‚æ„ŸçŸ¥æœºæ¨¡æ‹Ÿç”¨æˆ·ä¸é¡¹ç›®çš„äº¤äº’,è§£å†³äº†ä¸€äº›ä¼ ç»Ÿçš„æ¨èç®—æ³•çš„ä¸è¶³ã€‚å°½ç®¡åœ¨æ€§èƒ½ä¸Šæœ‰æ‰€æå‡,ä½†æ˜¯è¯¥ç®—æ³•ä½¿ç”¨çš„ç‰¹å¾ä¿¡æ¯è¾ƒä¸ºå•ä¸€,åªä½¿ç”¨äº†ç”¨æˆ·ä¸é¡¹ç›®çš„äº¤äº’ä¿¡æ¯,è€Œæ²¡æœ‰ä½¿ç”¨å…¶ä»–çš„è¾…åŠ©ä¿¡æ¯ã€‚è¾…åŠ©ä¿¡æ¯å¦‚ç”¨æˆ·ä¸é¡¹ç›®çš„å±æ€§æ ‡ç­¾ä¿¡æ¯å¯¹æé«˜æ¨¡å‹ä¸ªæ€§åŒ–æ¨èæ€§èƒ½ä»¥åŠç¼“è§£ç³»ç»Ÿå†·å¯åŠ¨å…·æœ‰é‡è¦ä½œç”¨,è‹¥èƒ½å°†è¿™äº›ä¿¡æ¯å¼•å…¥è‡³ç¥ç»ååŒè¿‡æ»¤æ¨¡å‹ä¸­,åˆ™å¯ä»¥ä½¿ç¥ç»ååŒè¿‡æ»¤æ¨¡å‹çš„æ¨èæ€§èƒ½æ›´å¥½ã€æ¨èå¯è§£é‡Šæ€§æ›´å¼ºã€‚</p><p>é—®é¢˜ï¼šæ¨¡å‹çš„å‚æ•°ä¸æ”¶æ•›æ—¶é—´å¢åŠ ã€æ¨¡å‹æ— æ³•å¾ˆå¥½åœ°æŒ–æ˜å¤šç§ä¿¡æ¯ç‰¹å¾ã€æ¨¡å‹å¯¹ç‰¹å¾ä¿¡æ¯è§†ä¸ºåŒç­‰é‡è¦,æ¶ˆè§£éƒ¨åˆ†æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p><p>NCFå¤ç° pytorchç‰ˆæœ¬</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;NCFè®ºæ–‡ç ”è¯»ç¬”è®°&quot;&gt;NCFè®ºæ–‡ç ”è¯»ç¬”è®°&lt;/h3&gt;
&lt;p&gt;éšç€è¿‘äº›å¹´æ¥æ·±åº¦å­¦ä¹ çš„å‘å±•ï¼Œåœ¨æ¨èç³»ç»Ÿæ–¹é¢ï¼Œè¶Šæ¥è¶Šå¤šçš„æ¨èæ¨¡å‹æ˜¯åŸºäºç¥ç»ç½‘ç»œæ¥è§£å†³æ¨èé—®é¢˜ï¼Œä½†è¿™äº›æ¨¡å‹ä¸»è¦ä½¿ç”¨å®ƒæ¥æ¨¡æ‹Ÿè¾…åŠ©ä¿¡æ¯ï¼Œä¾‹å¦‚é¡¹ç›®çš„æ–‡æœ¬æè¿°å’ŒéŸ³ä¹çš„å£°å­¦ç‰¹å¾ã€‚è€Œåœ¨å¯¹ååŒè¿‡æ»¤çš„å…³é”®å› ç´ â€”â€”ç”¨æˆ·å’Œé¡¹ç›®ç‰¹å¾</summary>
      
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://ruikey.cn/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
  </entry>
  
  <entry>
    <title>KNNå’ŒK-meansç®—æ³•</title>
    <link href="https://ruikey.cn/posts/b3bbb490.html"/>
    <id>https://ruikey.cn/posts/b3bbb490.html</id>
    <published>2024-08-11T10:19:03.000Z</published>
    <updated>2024-08-12T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="KNNå’ŒK-meansç®—æ³•">KNNå’ŒK-meansç®—æ³•</h2><h3 id="åŒºåˆ«">åŒºåˆ«</h3><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">KNN</th><th style="text-align:center">K-means</th></tr></thead><tbody><tr><td style="text-align:center">ç›®æ ‡</td><td style="text-align:center">ç›®æ ‡æ˜¯ä¸ºäº†ç¡®å®šä¸€ä¸ªç‚¹çš„åˆ†ç±»</td><td style="text-align:center">ç›®æ ‡æ˜¯ä¸ºäº†å°†ä¸€ç³»åˆ—ç‚¹é›†åˆ†æˆkç±»</td></tr><tr><td style="text-align:center">ç®—æ³•ç±»åˆ«</td><td style="text-align:center">åˆ†ç±»ç®—æ³•</td><td style="text-align:center">èšç±»ç®—æ³•</td></tr><tr><td style="text-align:center">å­¦ä¹ ç±»å‹</td><td style="text-align:center">ç›‘ç£å­¦ä¹ ï¼Œç±»åˆ«æ˜¯å·²çŸ¥çš„ï¼Œé€šè¿‡å¯¹å·²çŸ¥åˆ†ç±»çš„æ•°æ®è¿›è¡Œè®­ç»ƒå’Œå­¦ä¹ ï¼Œæ‰¾åˆ°è¿™äº›ä¸åŒç±»çš„ç‰¹å¾ï¼Œå†å¯¹æœªåˆ†ç±»çš„æ•°æ®è¿›è¡Œåˆ†ç±»</td><td style="text-align:center">éç›‘ç£å­¦ä¹ ï¼Œäº‹å…ˆä¸çŸ¥é“æ•°æ®ä¼šåˆ†ä¸ºå‡ ç±»ï¼Œé€šè¿‡èšç±»åˆ†æå°†æ•°æ®èšåˆæˆå‡ ä¸ªç¾¤ä½“ã€‚èšç±»ä¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œè®­ç»ƒå’Œå­¦ä¹ </td></tr><tr><td style="text-align:center">è®­ç»ƒæ•°æ®é›†</td><td style="text-align:center">è®­ç»ƒæ•°æ®é›†æœ‰labelï¼Œå·²ç»æ˜¯å®Œå…¨æ­£ç¡®çš„æ•°æ®</td><td style="text-align:center">è®­ç»ƒæ•°æ®é›†æ— labelï¼Œæ˜¯æ‚ä¹±æ— ç« çš„ï¼Œç»è¿‡èšç±»åæ‰å˜å¾—æœ‰ç‚¹é¡ºåºï¼Œå…ˆæ— åºï¼Œåæœ‰åº</td></tr><tr><td style="text-align:center">è®­ç»ƒè¿‡ç¨‹</td><td style="text-align:center">æ²¡æœ‰æ˜æ˜¾çš„å‰æœŸè®­ç»ƒè¿‡ç¨‹</td><td style="text-align:center">æœ‰æ˜æ˜¾çš„å‰æœŸè®­ç»ƒè¿‡ç¨‹</td></tr><tr><td style="text-align:center">Kå€¼ç»“æœ</td><td style="text-align:center">Kå€¼ç¡®å®šåæ¯æ¬¡ç»“æœå›ºå®š</td><td style="text-align:center">Kå€¼ç¡®å®šåæ¯æ¬¡ç»“æœå¯èƒ½ä¸åŒï¼Œä» nä¸ªæ•°æ®å¯¹è±¡ä»»æ„é€‰æ‹© k ä¸ªå¯¹è±¡ä½œä¸ºåˆå§‹èšç±»ä¸­å¿ƒï¼Œéšæœºæ€§å¯¹ç»“æœå½±å“è¾ƒå¤§</td></tr><tr><td style="text-align:center">æ—¶é—´å¤æ‚åº¦</td><td style="text-align:center">Oï¼ˆnï¼‰</td><td style="text-align:center">O(n<em>k</em>t)ï¼Œtä¸ºè¿­ä»£æ¬¡æ•°</td></tr></tbody></table><h2 id="K-æœ€è¿‘é‚»ç®—æ³•-KNN">K-æœ€è¿‘é‚»ç®—æ³•(KNN)</h2><h3 id="ä»‹ç»">ä»‹ç»</h3><p>K æœ€è¿‘é‚»ï¼ˆKNNï¼ŒK-NearestNeighborï¼‰åˆ†ç±»ç®—æ³•æ˜¯æ•°æ®æŒ–æ˜åˆ†ç±»æŠ€æœ¯ä¸­æœ€ç®€å•çš„æ–¹æ³•ä¹‹ä¸€ã€‚æ‰€è°“ K æœ€è¿‘é‚»ï¼Œå°±æ˜¯ K ä¸ªæœ€è¿‘çš„é‚»å±…çš„æ„æ€ï¼Œè¯´çš„æ˜¯æ¯ä¸ªæ ·æœ¬éƒ½å¯ä»¥ç”¨å®ƒæœ€æ¥è¿‘çš„ K ä¸ªé‚»è¿‘å€¼æ¥ä»£è¡¨ã€‚ K æœ€è¿‘é‚»ç®—æ³•å°±æ˜¯å°†æ•°æ®é›†åˆä¸­æ¯ä¸€ä¸ªè®°å½•è¿›è¡Œåˆ†ç±»çš„æ–¹æ³•ï¼Œæ˜¯ä¸€ä¸ªç†è®ºä¸Šæ¯”è¾ƒæˆç†Ÿçš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€ã€‚</p><h3 id="æ­¥éª¤">æ­¥éª¤</h3><p>å¯¹æœªçŸ¥ç±»åˆ«å±æ€§çš„æ•°æ®é›†ä¸­çš„æ¯ä¸ªç‚¹ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ“ä½œ:<br>(1) è®¡ç®—å·²çŸ¥ç±»åˆ«æ•°æ®é›†ä¸­çš„ç‚¹ä¸å½“å‰ç‚¹ä¹‹é—´çš„è·ç¦»;<br>(2) æŒ‰ç…§è·ç¦»é€’å¢æ¬¡åºæ’åº;<br>(3) é€‰å–ä¸å½“å‰ç‚¹è·ç¦»æœ€å°çš„kä¸ªç‚¹;<br>(4) ç¡®å®šå‰kä¸ªç‚¹æ‰€åœ¨ç±»åˆ«çš„å‡ºç°é¢‘ç‡;<br>(5) è¿”å›å‰kä¸ªç‚¹å‡ºç°é¢‘ç‡æœ€é«˜çš„ç±»åˆ«ä½œä¸ºå½“å‰ç‚¹çš„é¢„æµ‹åˆ†ç±»</p><h3 id="ä¸¾ä¸€ä¸ªå…³äºKNNç®—æ³•çš„ä¾‹é¢˜">ä¸¾ä¸€ä¸ªå…³äºKNNç®—æ³•çš„ä¾‹é¢˜</h3><p>å‡è®¾æœ‰å¦‚ä¸‹ 6 ä¸ªæ•°æ®ç‚¹ï¼Œå…¶ä¸­å‰ 5 ä¸ªä¸ºè®­ç»ƒæ•°æ®ï¼Œåˆ†åˆ«æœ‰ä¸¤ä¸ªç‰¹å¾ x1 å’Œ x2ã€‚æœ€åä¸€ä¸ªæ•°æ®ç‚¹æ˜¯æµ‹è¯•æ•°æ®ï¼Œéœ€è¦é€šè¿‡ KNN ç®—æ³•é¢„æµ‹å…¶æ‰€å±ç±»åˆ«ã€‚</p><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">x1</th><th style="text-align:center">x2</th><th style="text-align:center">ç±»åˆ«</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">4</td><td style="text-align:center">A</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">2</td><td style="text-align:center">3</td><td style="text-align:center">A</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">3</td><td style="text-align:center">6</td><td style="text-align:center">A</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">B</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">5</td><td style="text-align:center">8</td><td style="text-align:center">B</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">6</td><td style="text-align:center">7</td><td style="text-align:center">ï¼Ÿ</td></tr></tbody></table><p>æˆ‘ä»¬ç°åœ¨éœ€è¦ç”¨ KNN ç®—æ³•å¯¹ç¬¬ 6 ä¸ªæ•°æ®ç‚¹è¿›è¡Œåˆ†ç±»ã€‚å‡è®¾ K=3ï¼Œå³åœ¨è®­ç»ƒæ•°æ®ä¸­æ‰¾ä¸‰ä¸ªç¦»ç¬¬å…­ä¸ªæ•°æ®ç‚¹æœ€è¿‘çš„ç‚¹ï¼Œå†æ ¹æ®è¿™ä¸‰ä¸ªç‚¹çš„åˆ†ç±»æ¥åˆ¤æ–­ç¬¬å…­ä¸ªæ•°æ®ç‚¹çš„ç±»åˆ«ã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦ç”¨æ¬§æ°è·ç¦»è®¡ç®—æ¯ä¸ªè®­ç»ƒæ•°æ®ç‚¹å’Œç¬¬å…­ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210402203539984.png" alt="img"></p><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">x1</th><th style="text-align:center">x2</th><th style="text-align:center">ç±»åˆ«</th><th style="text-align:center">è·ç¦»</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">4</td><td style="text-align:center">A</td><td style="text-align:center">3.605</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">2</td><td style="text-align:center">3</td><td style="text-align:center">A</td><td style="text-align:center">3.162</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">3</td><td style="text-align:center">6</td><td style="text-align:center">A</td><td style="text-align:center">1.414</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">5.099</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">5</td><td style="text-align:center">8</td><td style="text-align:center">B</td><td style="text-align:center">2.236</td></tr></tbody></table><p>ç„¶åï¼Œå°†è·ç¦»ä»å°åˆ°å¤§æ’åºï¼Œå–è¾¾åˆ° K å€¼çš„å‰ K ä¸ªæ•°æ®ç‚¹ï¼š</p><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">x1</th><th style="text-align:center">x2</th><th style="text-align:center">ç±»åˆ«</th><th style="text-align:center">è·ç¦»</th></tr></thead><tbody><tr><td style="text-align:center">3</td><td style="text-align:center">3</td><td style="text-align:center">6</td><td style="text-align:center">A</td><td style="text-align:center">1.414</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">2</td><td style="text-align:center">3</td><td style="text-align:center">A</td><td style="text-align:center">3.162</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">5</td><td style="text-align:center">8</td><td style="text-align:center">B</td><td style="text-align:center">2.236</td></tr></tbody></table><p>æœ€åï¼Œç»Ÿè®¡å‰ K ä¸ªæ•°æ®ç‚¹ä¸­ç±»åˆ«æœ€å¤šçš„ç±»åˆ«ï¼Œå°†è¯¥ç±»åˆ«ä½œä¸ºç¬¬å…­ä¸ªæ•°æ®ç‚¹çš„é¢„æµ‹ç±»åˆ«ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‰ K ä¸ªæ•°æ®ç‚¹ä¸­ A çš„æ•°é‡ä¸º 2ï¼ŒB çš„æ•°é‡ä¸º 1ï¼Œå› æ­¤ç¬¬å…­ä¸ªæ•°æ®ç‚¹è¢«é¢„æµ‹ä¸º A ç±»ã€‚</p><p>è¿™å°±æ˜¯ KNN ç®—æ³•çš„åŸºæœ¬æµç¨‹ï¼Œé€šè¿‡è®¡ç®—è·ç¦»ã€æ’åºå’Œç»Ÿè®¡æ¥åˆ¤æ–­æ–°æ•°æ®ç‚¹çš„ç±»åˆ«ã€‚åœ¨å®é™…åº”ç”¨ä¸­éœ€è¦æ ¹æ®ä¸åŒçš„åœºæ™¯æ¥é€‰æ‹©åˆé€‚çš„è·ç¦»åº¦é‡æ–¹æ³•å’Œ K å€¼ï¼Œä»è€Œæ¥è¾¾åˆ°æœ€å¥½çš„åˆ†ç±»æ•ˆæœã€‚</p><h3 id="ä»£ç ">ä»£ç </h3><p>ä»£ç ä¾æ®æ­¥éª¤è€Œå†™ï¼Œä»èœé¸Ÿæ•™ç¨‹ä¸Šæ‰¾ç†è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ•°æ®é›†</span></span><br><span class="line">X_train = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    [<span class="number">3</span>, <span class="number">6</span>, <span class="string">&#x27;A&#x27;</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">2</span>, <span class="string">&#x27;B&#x27;</span>],</span><br><span class="line">    [<span class="number">5</span>, <span class="number">8</span>, <span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•æ•°æ®é›†</span></span><br><span class="line">X_test = [<span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¬§æ°è·ç¦»è®¡ç®—å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">euclidean_distance</span>(<span class="params">x1, x2</span>):</span><br><span class="line">    distance = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x1)):</span><br><span class="line">        distance += (x1[i] - x2[i]) ** <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> sqrt(distance)</span><br><span class="line"></span><br><span class="line"><span class="comment"># KNN ç®—æ³•å®ç°å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">knn</span>(<span class="params">X_train, X_test, k</span>):</span><br><span class="line">    <span class="comment"># ä¿å­˜è·ç¦»åŠå…¶ç±»åˆ«çš„åˆ—è¡¨</span></span><br><span class="line">    distances = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†è®­ç»ƒæ•°æ®é›†ï¼Œè®¡ç®—æ¯ä¸ªæ ·æœ¬ä¸æµ‹è¯•æ•°æ®ä¹‹é—´çš„è·ç¦»ï¼Œå¹¶ä¿å­˜è·ç¦»åŠå…¶ç±»åˆ«</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_train)):</span><br><span class="line">        dist = euclidean_distance(X_train[i][:<span class="number">2</span>], X_test)</span><br><span class="line">        label = X_train[i][-<span class="number">1</span>]</span><br><span class="line">        distances.append((dist, label))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†è·ç¦»åˆ—è¡¨æŒ‰ç…§è·ç¦»ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">    distances.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰¾å‡ºå‰ K ä¸ªè·ç¦»æœ€è¿‘çš„ç‚¹</span></span><br><span class="line">    k_nearest_neighbors = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        k_nearest_neighbors.append(distances[i][-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç»Ÿè®¡å‰ K ä¸ªç‚¹ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«ï¼Œå³ä¸ºæµ‹è¯•æ•°æ®çš„é¢„æµ‹ç±»åˆ«</span></span><br><span class="line">    most_common = Counter(k_nearest_neighbors).most_common(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> most_common[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡è®¾ K=3ï¼Œå°†æµ‹è¯•æ•°æ®åˆ†ç±»</span></span><br><span class="line">predicted_class = knn(X_train, X_test, k=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºé¢„æµ‹ç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Predicted class for X_test is:&quot;</span>, predicted_class)</span><br></pre></td></tr></table></figure><p>ä»£ç è§£æï¼š</p><p>1.é¦–å…ˆå®šä¹‰äº†è®­ç»ƒæ•°æ®é›† X_train å’Œæµ‹è¯•æ•°æ®é›† X_testã€‚<br>2.å®šä¹‰äº†ä¸€ä¸ªæ¬§æ°è·ç¦»è®¡ç®—å‡½æ•° euclidean_distance()ï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„æ¬§æ°è·ç¦»ã€‚<br>3.å®šä¹‰äº† KNN ç®—æ³•å®ç°å‡½æ•° knn()ï¼Œå…¶ä¸­æŒ‰ç…§æµç¨‹å…ˆè®¡ç®—æ‰€æœ‰è®­ç»ƒæ•°æ®ç‚¹ä¸æµ‹è¯•æ•°æ®ä¹‹é—´çš„è·ç¦»ï¼Œç„¶åå°†è·ç¦»ä»å°åˆ°å¤§æ’åºï¼Œå¹¶é€‰å‡ºå‰ K    ä¸ªè·ç¦»æœ€è¿‘çš„æ•°æ®ç‚¹ï¼Œç»Ÿè®¡è¿™äº›æ•°æ®ç‚¹ä¸­æ¯ä¸ªç±»åˆ«å‡ºç°çš„æ¬¡æ•°å¹¶æ‰¾åˆ°å‡ºç°æ¬¡æ•°æœ€å¤šçš„é‚£ä¸ªç±»åˆ«ï¼Œå³ä¸ºæµ‹è¯•æ•°æ®çš„é¢„æµ‹ç±»åˆ«ã€‚<br>4.åœ¨ä¸»ç¨‹åºä¸­è°ƒç”¨ knn() å‡½æ•°ï¼Œå‡è®¾ K=3ï¼Œå°†æµ‹è¯•æ•°æ®åˆ†ç±»ï¼Œå¹¶è¾“å‡ºé¢„æµ‹ç»“æœã€‚</p><p>å›¾åƒä»£ç ä¸è¿‡å¤šé˜è¿°</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/71493627e805d359646b2fd43a18bd6e.png" alt="image"></p><h2 id="Kå‡å€¼ç®—æ³•-K-means">Kå‡å€¼ç®—æ³•(K-means)</h2><h3 id="ä»‹ç»-2">ä»‹ç»</h3><p>èšç±»ç®—æ³•ï¼Œå°†ä¸€å †æ•°æ®åˆ’åˆ†æˆåˆ°ä¸åŒçš„ç»„ä¸­ã€‚æ ¹æ®æ ·æœ¬ç‰¹å¾çš„ç›¸ä¼¼åº¦æˆ–è·ç¦»è¿œè¿‘ï¼Œå°†å…¶åˆ’åˆ†æˆè‹¥å¹²ä¸ªç±»ã€‚</p><p>èšç±»ï¼šç‰©ç†æˆ–æŠ½è±¡å¯¹è±¡çš„é›†åˆåˆ†æˆç”±ç±»ä¼¼çš„å¯¹è±¡ç»„æˆçš„å¤šä¸ªç±»çš„è¿‡ç¨‹è¢«ç§°ä¸ºèšç±»ã€‚ç”±èšç±»æ‰€ç”Ÿæˆçš„ç°‡æ˜¯ä¸€ç»„æ•°æ®å¯¹è±¡çš„é›†åˆï¼Œè¿™äº›å¯¹è±¡ä¸åŒä¸€ä¸ªç°‡ä¸­çš„å¯¹è±¡å½¼æ­¤ç›¸ä¼¼ï¼Œä¸å…¶ä»–ç°‡ä¸­çš„å¯¹è±¡ç›¸å¼‚ã€‚</p><p>ç°‡ï¼šæœ¬ç®—æ³•ä¸­å¯ä»¥ç†è§£ä¸ºï¼ŒæŠŠæ•°æ®é›†èšç±»æˆ k ç±»ï¼Œå³ k ä¸ªç°‡ã€‚</p><p>è´¨å¿ƒï¼šæŒ‡å„ä¸ªç±»åˆ«çš„ä¸­å¿ƒä½ç½®ï¼Œå³ç°‡ä¸­å¿ƒã€‚</p><h3 id="æ­¥éª¤-2">æ­¥éª¤</h3><ol><li>ä»æ•°æ®ä¸­é€‰æ‹©kä¸ªå¯¹è±¡ä½œä¸ºåˆå§‹èšç±»ä¸­å¿ƒ</li><li>è®¡ç®—æ¯ä¸ªèšç±»å¯¹è±¡åˆ°èšç±»ä¸­å¿ƒçš„è·ç¦»æ¥åˆ’åˆ†</li><li>å†æ¬¡è®¡ç®—æ¯ä¸ªèšç±»ä¸­å¿ƒ</li><li>è®¡ç®—æ ‡å‡†æµ‹åº¦å‡½æ•°ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°æˆ–è€…æ»¡è¶³æ”¶æ•›æ¡ä»¶ï¼Œåˆ™åœæ­¢ï¼Œå¦åˆ™ï¼Œç»§ç»­2æ“ä½œ</li></ol><h3 id="ä¼ªä»£ç ">ä¼ªä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å¤æ‚åº¦</span><br><span class="line">æˆ‘ä»¬å…ˆçœ‹ä¸‹ä¼ªä»£ç ï¼š</span><br><span class="line"></span><br><span class="line">è·å–æ•°æ® n ä¸ª m ç»´çš„æ•°æ®</span><br><span class="line">éšæœºç”Ÿæˆ K ä¸ª m ç»´çš„ç‚¹</span><br><span class="line"><span class="keyword">while</span>(t)</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i &lt; n;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> j=<span class="number">0</span>;j &lt; k;j++)</span><br><span class="line">            è®¡ç®—ç‚¹ i åˆ°ç±» j çš„è·ç¦»</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i &lt; k;i++)</span><br><span class="line">        <span class="number">1.</span> æ‰¾å‡ºæ‰€æœ‰å±äºè‡ªå·±è¿™ä¸€ç±»çš„æ‰€æœ‰æ•°æ®ç‚¹</span><br><span class="line">        <span class="number">2.</span> æŠŠè‡ªå·±çš„åæ ‡ä¿®æ”¹ä¸ºè¿™äº›æ•°æ®ç‚¹çš„ä¸­å¿ƒç‚¹åæ ‡</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼š $O(tknm)$ï¼Œå…¶ä¸­ï¼Œt ä¸ºè¿­ä»£æ¬¡æ•°ï¼Œk ä¸ºç°‡çš„æ•°ç›®ï¼Œn ä¸ºæ ·æœ¬ç‚¹æ•°ï¼Œm ä¸ºæ ·æœ¬ç‚¹ç»´åº¦ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼š $O(m(n+k))$ï¼Œå…¶ä¸­ï¼Œk ä¸ºç°‡çš„æ•°ç›®ï¼Œm ä¸ºæ ·æœ¬ç‚¹ç»´åº¦ï¼Œn ä¸ºæ ·æœ¬ç‚¹æ•°ã€‚</p><h3 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h3><h4 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h4><ul><li>å®¹æ˜“ç†è§£ï¼Œèšç±»æ•ˆæœä¸é”™ï¼Œè™½ç„¶æ˜¯å±€éƒ¨æœ€ä¼˜ï¼Œ ä½†å¾€å¾€å±€éƒ¨æœ€ä¼˜å°±å¤Ÿäº†ï¼›</li><li>å¤„ç†å¤§æ•°æ®é›†çš„æ—¶å€™ï¼Œè¯¥ç®—æ³•å¯ä»¥ä¿è¯è¾ƒå¥½çš„ä¼¸ç¼©æ€§ï¼›</li><li>å½“ç°‡è¿‘ä¼¼é«˜æ–¯åˆ†å¸ƒçš„æ—¶å€™ï¼Œæ•ˆæœéå¸¸ä¸é”™ï¼›</li><li>ç®—æ³•å¤æ‚åº¦ä½ã€‚</li></ul><h4 id="ç¼ºç‚¹">ç¼ºç‚¹</h4><ul><li>K å€¼éœ€è¦äººä¸ºè®¾å®šï¼Œä¸åŒ K å€¼å¾—åˆ°çš„ç»“æœä¸ä¸€æ ·ï¼›</li><li>å¯¹åˆå§‹çš„ç°‡ä¸­å¿ƒæ•æ„Ÿï¼Œä¸åŒé€‰å–æ–¹å¼ä¼šå¾—åˆ°ä¸åŒç»“æœï¼›</li><li>å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼›</li><li>æ ·æœ¬åªèƒ½å½’ä¸ºä¸€ç±»ï¼Œä¸é€‚åˆå¤šåˆ†ç±»ä»»åŠ¡ï¼›</li><li>ä¸é€‚åˆå¤ªç¦»æ•£çš„åˆ†ç±»ã€æ ·æœ¬ç±»åˆ«ä¸å¹³è¡¡çš„åˆ†ç±»ã€éå‡¸å½¢çŠ¶çš„åˆ†ç±»ã€‚</li></ul><h3 id="ä¸¾ä¸€ä¸ªå…³äºK-meansç®—æ³•çš„ä¾‹é¢˜">ä¸¾ä¸€ä¸ªå…³äºK-meansç®—æ³•çš„ä¾‹é¢˜</h3><p>å¦‚æœç°‡çš„æ•°ç›®k=2ï¼Œæ ¹æ®ä¸‹è¡¨æ•°æ®ï¼ˆn=8ï¼‰è¡Œæ•°æ®ï¼ŒæŒ‰ç…§k-meansç®—æ³•ï¼Œå†™å‡ºæ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä»¥åŠæœ€ç»ˆå¾—åˆ°ç°‡çš„æ•°æ®æ‰€åœ¨çš„åºå·çš„é›†åˆã€‚</p><table><thead><tr><th style="text-align:center">åºå·</th><th style="text-align:center">å±æ€§1</th><th style="text-align:center">å±æ€§2</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">2</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">1</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">4</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">5</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">4</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">5</td><td style="text-align:center">4</td></tr></tbody></table><p>æç¤ºï¼šï¼ˆ1ï¼‰ç¬¬ä¸€æ¬¡è¿­ä»£å…ˆéšæœºæ‰¾ä¸¤è¡Œæ•°æ®ï¼Œå¦‚ç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œå½“ä¸ºåˆå§‹ç‚¹ã€‚</p><p>â€‹ï¼ˆ2ï¼‰è®¡ç®—è·ç¦»ï¼Œå¯ä»¥ç”¨æ¬§å¼è·ç¦»ï¼ˆä¸Šæ–‡æåˆ°è¿‡ï¼‰</p><h3 id="æ‰‹å†™æ¨æ¼”">æ‰‹å†™æ¨æ¼”</h3><p><img src="https://file.imgcc.cloud/images/2024/08/13/c3bd2842f93e58927707150294bc0bbb.png" alt="image"></p><h3 id="ä»£ç -2">ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ KMeans ç®—æ³•ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">KMeans</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, k=<span class="number">2</span>, max_iter=<span class="number">100</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.k = k</span><br><span class="line">        <span class="variable language_">self</span>.max_iter = max_iter</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®­ç»ƒæ¨¡å‹å‡½æ•°ï¼Œå°†æ•°æ®é›†åˆ†ä¸º k ä¸ªç°‡ï¼Œå¹¶è¿”å›æ¯ä¸ªæ•°æ®ç‚¹æ‰€å±çš„ç°‡çš„åºå·</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, X</span>):</span><br><span class="line">        centroids = X[np.random.choice(<span class="built_in">len</span>(X), <span class="variable language_">self</span>.k, replace=<span class="literal">False</span>)] <span class="comment"># éšæœºé€‰æ‹© k ä¸ªæ•°æ®ç‚¹ä½œä¸ºç°‡çš„åˆå§‹ä¸­å¿ƒ</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.max_iter):</span><br><span class="line">            distances = np.<span class="built_in">sum</span>((X - centroids[:, np.newaxis]) ** <span class="number">2</span>, axis=<span class="number">2</span>) <span class="comment"># è®¡ç®—æ¯ä¸ªæ•°æ®ç‚¹åˆ°å„ä¸ªç°‡ä¸­å¿ƒçš„è·ç¦»</span></span><br><span class="line">            labels = np.argmin(distances, axis=<span class="number">0</span>) <span class="comment"># å°†æ¯ä¸ªæ•°æ®ç‚¹å½’å±åˆ°è·ç¦»æœ€è¿‘çš„ç°‡</span></span><br><span class="line">            new_centroids = np.array([X[labels == j].mean(axis=<span class="number">0</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.k)]) <span class="comment"># è®¡ç®—æ–°çš„ç°‡ä¸­å¿ƒä½ç½®</span></span><br><span class="line">            <span class="keyword">if</span> np.allclose(new_centroids, centroids): <span class="comment"># å¦‚æœæ–°ä¸­å¿ƒå’Œæ—§ä¸­å¿ƒç›¸åŒï¼Œåˆ™ç®—æ³•æ”¶æ•›</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            centroids = new_centroids <span class="comment"># æ›´æ–°ä¸­å¿ƒ</span></span><br><span class="line">        <span class="keyword">return</span> labels</span><br><span class="line">    </span><br><span class="line"><span class="comment"># å®šä¹‰æ•°æ®é›†</span></span><br><span class="line">X = np.array([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">2</span>], [<span class="number">4</span>, <span class="number">3</span>], [<span class="number">5</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">4</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– KMeans æ¨¡å‹å¯¹è±¡ï¼Œè®¾ç½® k=2</span></span><br><span class="line">kmeans = KMeans(k=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹å¹¶è¾“å‡ºæ¯ä¸ªæ•°æ®ç‚¹æ‰€å±çš„ç°‡çš„åºå·</span></span><br><span class="line">labels = kmeans.fit(X)</span><br><span class="line"><span class="built_in">print</span>(labels)</span><br></pre></td></tr></table></figure><p>ä»£ç è§£æï¼š</p><p>1.å®šä¹‰ KMeans ç®—æ³•ç±» KMeansï¼Œå…¶ä¸­åŒ…æ‹¬åˆå§‹åŒ–å‡½æ•° <strong>init</strong>() å’Œè®­ç»ƒæ¨¡å‹å‡½æ•° fit()ã€‚åœ¨ fit() å‡½æ•°ä¸­ï¼Œé¦–å…ˆéšæœºé€‰æ‹© k ä¸ªæ•°æ®ç‚¹ä½œä¸ºåˆå§‹ç°‡ä¸­å¿ƒï¼Œç„¶åè¿­ä»£è‹¥å¹²æ¬¡ï¼Œæ¯æ¬¡è®¡ç®—æ‰€æœ‰æ•°æ®ç‚¹åˆ°å„ä¸ªç°‡ä¸­å¿ƒçš„è·ç¦»ï¼Œå°†æ¯ä¸ªæ•°æ®ç‚¹å½’å±åˆ°è·ç¦»æœ€è¿‘çš„ç°‡ï¼Œå¹¶è®¡ç®—æ–°çš„ç°‡ä¸­å¿ƒä½ç½®ï¼›å¦‚æœæ–°ä¸­å¿ƒå’Œæ—§ä¸­å¿ƒç›¸åŒï¼Œåˆ™ç®—æ³•æ”¶æ•›ï¼Œåœæ­¢è¿­ä»£ã€‚<br>2.å®šä¹‰æ•°æ®é›† Xã€‚<br>3.åˆå§‹åŒ– KMeans æ¨¡å‹å¯¹è±¡ kmeansï¼Œå¹¶å°† k å€¼è®¾ç½®ä¸º 2ã€‚<br>è®­ç»ƒæ¨¡å‹å¹¶è¾“å‡ºæ¯ä¸ªæ•°æ®ç‚¹æ‰€å±çš„ç°‡çš„åºå·ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;KNNå’ŒK-meansç®—æ³•&quot;&gt;KNNå’ŒK-meansç®—æ³•&lt;/h2&gt;
&lt;h3 id=&quot;åŒºåˆ«&quot;&gt;åŒºåˆ«&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;&lt;/th&gt;
&lt;th style=&quot;text-align</summary>
      
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://ruikey.cn/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¢¯åº¦ä¸‹é™ç®—æ³•</title>
    <link href="https://ruikey.cn/posts/2a27add3.html"/>
    <id>https://ruikey.cn/posts/2a27add3.html</id>
    <published>2024-08-11T10:19:00.000Z</published>
    <updated>2024-08-12T14:10:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ¢¯åº¦ä¸‹é™ç®—æ³•">æ¢¯åº¦ä¸‹é™ç®—æ³•</h2><h3 id="äºŒç»´æ¢¯åº¦ä¸‹é™">äºŒç»´æ¢¯åº¦ä¸‹é™</h3><h4 id="èƒŒæ™¯å¼•å…¥">èƒŒæ™¯å¼•å…¥</h4><p>â€‹æ¢¯åº¦ä¸‹é™æ³•ï¼ˆgradient descentï¼‰ï¼Œåˆåæœ€é€Ÿä¸‹é™æ³•ï¼ˆsteepest descentï¼‰æ˜¯æ±‚è§£æ— çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç§è¿­ä»£æ–¹æ³•ï¼Œæ¯ä¸€æ­¥ä¸»è¦çš„æ“ä½œæ˜¯æ±‚è§£ç›®æ ‡å‡½æ•°çš„æ¢¯åº¦å‘é‡ï¼Œå°†å½“å‰ä½ç½®çš„è´Ÿæ¢¯åº¦æ–¹å‘ä½œä¸ºæœç´¢æ–¹å‘ï¼ˆå› ä¸ºåœ¨è¯¥æ–¹å‘ä¸Šç›®æ ‡å‡½æ•°ä¸‹é™æœ€å¿«ï¼Œè¿™ä¹Ÿæ˜¯æœ€é€Ÿä¸‹é™æ³•åç§°çš„ç”±æ¥ï¼‰ã€‚</p><p>â€‹æ¢¯åº¦ä¸‹é™æ³•ç‰¹ç‚¹ï¼š==è¶Šæ¥è¿‘ç›®æ ‡å€¼ï¼Œæ­¥é•¿è¶Šå°ï¼Œä¸‹é™é€Ÿåº¦è¶Šæ…¢ã€‚==</p><p>â€‹æ¢¯åº¦ä¸‹é™æ³•çš„åŸºæœ¬æ€æƒ³å¯ä»¥ç±»æ¯”ä¸ºä¸€ä¸ªä¸‹å±±çš„è¿‡ç¨‹ã€‚</p><p>â€‹å‡è®¾è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä¸€ä¸ªäººè¢«å›°åœ¨å±±ä¸Šï¼Œéœ€è¦ä»å±±ä¸Šä¸‹æ¥(æ‰¾åˆ°å±±çš„æœ€ä½ç‚¹ï¼Œä¹Ÿå°±æ˜¯å±±è°·)ã€‚ä½†æ­¤æ—¶å±±ä¸Šçš„æµ“é›¾å¾ˆå¤§ï¼Œå¯¼è‡´å¯è§†åº¦å¾ˆä½ï¼›å› æ­¤ï¼Œä¸‹å±±çš„è·¯å¾„å°±æ— æ³•ç¡®å®šï¼Œå¿…é¡»åˆ©ç”¨è‡ªå·±å‘¨å›´çš„ä¿¡æ¯ä¸€æ­¥ä¸€æ­¥åœ°æ‰¾åˆ°ä¸‹å±±çš„è·¯ã€‚è¿™ä¸ªæ—¶å€™ï¼Œä¾¿å¯åˆ©ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ¥å¸®åŠ©è‡ªå·±ä¸‹å±±ã€‚æ€ä¹ˆåšå‘¢ï¼Œé¦–å…ˆä»¥ä»–å½“å‰çš„æ‰€å¤„çš„ä½ç½®ä¸ºåŸºå‡†ï¼Œå¯»æ‰¾è¿™ä¸ªä½ç½®æœ€é™¡å³­çš„åœ°æ–¹ï¼Œç„¶åæœç€ä¸‹é™æ–¹å‘èµ°ä¸€æ­¥ï¼Œç„¶ååˆç»§ç»­ä»¥å½“å‰ä½ç½®ä¸ºåŸºå‡†ï¼Œå†æ‰¾æœ€é™¡å³­çš„åœ°æ–¹ï¼Œå†èµ°ç›´åˆ°æœ€ååˆ°è¾¾æœ€ä½å¤„ï¼›åŒç†ä¸Šå±±ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåªæ˜¯è¿™æ—¶å€™å°±å˜æˆæ¢¯åº¦ä¸Šå‡ç®—æ³•äº†</p><p>â€‹æ¢¯åº¦ä¸‹é™çš„åŸºæœ¬è¿‡ç¨‹å°±å’Œä¸‹å±±çš„åœºæ™¯å¾ˆç±»ä¼¼ã€‚</p><p>â€‹é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¯å¾®åˆ†çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å°±ä»£è¡¨ç€ä¸€åº§å±±ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°è¿™ä¸ªå‡½æ•°çš„æœ€å°å€¼ï¼Œä¹Ÿå°±æ˜¯å±±åº•ã€‚æ ¹æ®ä¹‹å‰çš„åœºæ™¯å‡è®¾ï¼Œæœ€å¿«çš„ä¸‹å±±çš„æ–¹å¼å°±æ˜¯æ‰¾åˆ°å½“å‰ä½ç½®æœ€é™¡å³­çš„æ–¹å‘ï¼Œç„¶åæ²¿ç€æ­¤æ–¹å‘å‘ä¸‹èµ°ï¼Œå¯¹åº”åˆ°å‡½æ•°ä¸­ï¼Œå°±æ˜¯æ‰¾åˆ°ç»™å®šç‚¹çš„æ¢¯åº¦ ï¼Œç„¶åæœç€æ¢¯åº¦ç›¸åçš„æ–¹å‘ï¼Œå°±èƒ½è®©å‡½æ•°å€¼ä¸‹é™çš„æœ€å¿«ï¼å› ä¸ºæ¢¯åº¦çš„æ–¹å‘å°±æ˜¯å‡½æ•°ä¹‹å˜åŒ–æœ€å¿«çš„æ–¹å‘(åœ¨åé¢ä¼šè¯¦ç»†è§£é‡Š)<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬é‡å¤åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œåå¤æ±‚å–æ¢¯åº¦ï¼Œæœ€åå°±èƒ½åˆ°è¾¾å±€éƒ¨çš„æœ€å°å€¼ï¼Œè¿™å°±ç±»ä¼¼äºæˆ‘ä»¬ä¸‹å±±çš„è¿‡ç¨‹ã€‚è€Œæ±‚å–æ¢¯åº¦å°±ç¡®å®šäº†æœ€é™¡å³­çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯åœºæ™¯ä¸­æµ‹é‡æ–¹å‘çš„æ‰‹æ®µã€‚</p><h4 id="æ¨å¯¼">æ¨å¯¼</h4><p>æ‰€è°“æœ€å¿«ä¸‹é™æ–¹æ¡ˆï¼Œæ— ç–‘æ˜¯æ±‚å‡½æ•°å›¾åƒä¸­ï¼ŒæŸç‚¹çš„åˆ‡çº¿çš„æ–œç‡ï¼Œå‡½æ•°çš„å˜åŒ–ç‡</p><p>1.å•å˜é‡çš„å¾®åˆ†ï¼Œå‡½æ•°åªæœ‰ä¸€ä¸ªå˜é‡æ—¶</p><p>2.å¤šå˜é‡çš„å¾®åˆ†ï¼Œå½“å‡½æ•°æœ‰å¤šä¸ªå˜é‡çš„æ—¶å€™ï¼Œå³åˆ†åˆ«å¯¹æ¯ä¸ªå˜é‡è¿›è¡Œæ±‚å¾®åˆ†</p><p>æ¢ä¸ªæ–¹å¼æƒ³æƒ³ï¼Œäººæƒ³è¦æœ€å¿«ä¸‹å±±ï¼Œæ˜¯ä¸æ˜¯è¦ä»æœ€æŠ–çš„åœ°æ–¹å¼€å§‹èµ°ï¼Œæ¢¯åº¦çš„æ–¹å‘æ˜¯å‡½æ•°åœ¨ç»™å®šç‚¹ä¸Šå‡æœ€å¿«çš„æ–¹å‘ï¼Œé‚£ä¹ˆæ¢¯åº¦çš„åæ–¹å‘å°±æ˜¯å‡½æ•°åœ¨ç»™å®šç‚¹ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼Œé‚£ä¹ˆæ²¿ç€æ¢¯åº¦èµ°ä¸ä½†èƒ½åˆ°ç»ˆç‚¹ï¼Œè€Œä¸”è¿‡ç¨‹æœ€å¿«</p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¼€å§‹å‰–æå…¬å¼</p><h4 id="å…¬å¼">å…¬å¼</h4><p>åˆå§‹ï¼š</p><p>$Î˜^1=Î˜^0-Î±*Jâ€²(Î˜^0)â†’evaluatedatÎ˜^0$</p><p>$Î˜^0$ä»£è¡¨èµ·å§‹ä½ç½®ï¼Œ$Î˜^{0+1}$ä»£è¡¨ä¸‹ä¸€ä¸ªçŠ¶æ€çš„ä½ç½®</p><p>Î±ä»£è¡¨æ­¥é•¿ï¼Œå³ä¹Ÿå°±æ˜¯å­¦ä¹ ç‡ï¼Œå¦‚æœå­¦ä¹ ç‡ä¸åˆé€‚å¯èƒ½ä¼šå¯¼è‡´å‘ç”Ÿé”™è¯¯</p><p>ç”±æ­¤æ¨ä¹‹</p><p>$Î˜^{n+1}=Î˜^n-Î±*Jâ€²(Î˜^n)â†’evaluatedatÎ˜^n$</p><p>æ³¨æ„ï¼š</p><ul><li>å½“é è¿‘æå°å€¼æ—¶æ”¶æ•›é€Ÿåº¦å‡æ…¢</li><li>ä¸‹é™è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç° â€œä¹‹å­—å½¢â€ åœ°ä¸‹é™</li><li>ä»£ç å±‚é¢éœ€è¦è®¾ç½®åœæ­¢è¿ç®—æ¡ä»¶ç›´åˆ°åˆ°è¾¾æŒ‡å®šç²¾åº¦æˆ–è€…æŒ‡å®šè¿ç®—æ¬¡æ•°åœæ­¢</li></ul><h4 id="ä¾‹é¢˜ï¼š">ä¾‹é¢˜ï¼š</h4><p>ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚ $y=x^2/2-2x$çš„æå€¼ã€‚<br>æç¤ºï¼šåˆå§‹å€¼$x~0=-4$ å­¦ä¹ ç‡ $Î·=0.9$ï¼Œç»ˆæ­¢æ¡ä»¶ï¼šÎ”x&lt;Îµ=0.01ã€‚</p><h4 id="æ‰‹å†™æ¨æ¼”ï¼š">æ‰‹å†™æ¨æ¼”ï¼š</h4><p><img src="https://file.imgcc.cloud/images/2024/08/13/ced32a04871b81e1017887b05264cd7b.png" alt="image"></p><h4 id="ä»£ç å’Œè¿è¡Œç»“æœï¼š">ä»£ç å’Œè¿è¡Œç»“æœï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å‡½æ•° y = x^2 / 2 - 2x</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ** <span class="number">2</span> / <span class="number">2</span> - <span class="number">2</span> * x</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å‡½æ•° y å¯¹ x çš„å¯¼æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfunc</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x - <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ¢¯åº¦ä¸‹é™å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradient_descent</span>(<span class="params">x0, eta, epsilon</span>):</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–</span></span><br><span class="line">    x = x0</span><br><span class="line">    v = <span class="number">0</span></span><br><span class="line">    delta_x = epsilon + <span class="number">1</span></span><br><span class="line">    result_x = [x]</span><br><span class="line">    result_y = [func(x)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿­ä»£æ›´æ–°å‚æ•°ï¼Œç›´åˆ°æ»¡è¶³ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">while</span> delta_x &gt; epsilon:</span><br><span class="line">        <span class="comment"># è®¡ç®—å¯¼æ•°</span></span><br><span class="line">        vd = dfunc(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°é€Ÿåº¦å’Œä½ç½®</span></span><br><span class="line">        v = -eta * vd</span><br><span class="line">        x += v</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¡ç®—å½“å‰ç‚¹ä¸ä¸Šä¸€ä¸ªç‚¹çš„è·ç¦»</span></span><br><span class="line">        delta_x = <span class="built_in">abs</span>(result_x[-<span class="number">1</span>] - x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä¿å­˜æ¯æ¬¡è¿­ä»£å¾—åˆ°çš„ç»“æœ</span></span><br><span class="line">        result_x.append(x)</span><br><span class="line">        result_y.append(func(x))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (result_x, result_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®åˆå§‹å€¼ã€å­¦ä¹ ç‡å’Œç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">x0 = -<span class="number">4</span></span><br><span class="line">eta = <span class="number">0.9</span></span><br><span class="line">epsilon = <span class="number">0.01</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨æ¢¯åº¦ä¸‹é™å‡½æ•°æ±‚è§£</span></span><br><span class="line">result_x, result_y = gradient_descent(x0, eta, epsilon)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ±‚å¾—çš„æå€¼ç‚¹æ¨ªåæ ‡ä¸ºï¼š&quot;</span>, result_x[-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€ç»ˆè¯¯å·®ï¼š&quot;</span>, <span class="built_in">abs</span>(result_y[-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶å‡½æ•°å›¾åƒ</span></span><br><span class="line">x = [i / <span class="number">10</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">40</span>, <span class="number">60</span>)]</span><br><span class="line">y = [func(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">plt.plot(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ¢¯åº¦ä¸‹é™è¿‡ç¨‹å›¾åƒ</span></span><br><span class="line">plt.plot(result_x, result_y, color=<span class="string">&#x27;r&#x27;</span>, marker=<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ ‡é¢˜</span></span><br><span class="line">plt.title(<span class="string">&quot;y = x^2 / 2 - 2x, Î· = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(eta))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå›¾åƒ</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚å›¾</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/c907a367714f1061380076946817526c.png" alt="image"></p><h3 id="æ¢¯åº¦ä¸‹é™ä¸‰ç§å½¢å¼ï¼ˆBGDï¼ŒSGDï¼ŒMBGDï¼‰">æ¢¯åº¦ä¸‹é™ä¸‰ç§å½¢å¼ï¼ˆBGDï¼ŒSGDï¼ŒMBGDï¼‰</h3><h4 id="æ‰¹é‡æ¢¯åº¦ä¸‹é™">æ‰¹é‡æ¢¯åº¦ä¸‹é™</h4><p>æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•æ¯æ¬¡éƒ½ä½¿ç”¨è®­ç»ƒé›†ä¸­çš„æ‰€æœ‰æ ·æœ¬æ›´æ–°å‚æ•°ã€‚å®ƒå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå…¨å±€æœ€ä¼˜è§£ï¼Œä½†æ˜¯æ¯è¿­ä»£ä¸€æ­¥ï¼Œéƒ½è¦ç”¨åˆ°è®­ç»ƒé›†æ‰€æœ‰çš„æ•°æ®ï¼Œå¦‚æœå¾ˆå¤§ï¼Œé‚£ä¹ˆè¿­ä»£é€Ÿåº¦å°±ä¼šå˜å¾—å¾ˆæ…¢ã€‚ ä¼˜ç‚¹ï¼šå¯ä»¥å¾—å‡ºå…¨å±€æœ€ä¼˜è§£ã€‚ ç¼ºç‚¹ï¼šæ ·æœ¬æ•°æ®é›†å¤§æ—¶ï¼Œè®­ç»ƒé€Ÿåº¦æ…¢ã€‚</p><h4 id="éšæœºæ¢¯åº¦ä¸‹é™">éšæœºæ¢¯åº¦ä¸‹é™</h4><p>ç”±äºæ‰¹æ¢¯åº¦ä¸‹é™æ¯è·Ÿæ–°ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œè¦ç”¨åˆ°æ‰€æœ‰çš„æ ·æœ¬æ•°ï¼Œæ‰€ä»¥è®­ç»ƒé€Ÿåº¦ä¼šéšç€æ ·æœ¬æ•°é‡çš„å¢åŠ è€Œå˜å¾—éå¸¸ç¼“æ…¢ã€‚éšæœºæ¢¯åº¦ä¸‹é™æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªåŠæ³•è€Œæå‡ºçš„ã€‚å®ƒæ˜¯åˆ©ç”¨æ¯ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°å¯¹Î¸æ±‚åå¯¼å¾—åˆ°å¯¹åº”çš„æ¢¯åº¦ï¼Œæ¥æ›´æ–°Î¸</p><p>éšæœºæ¢¯åº¦ä¸‹é™æ˜¯é€šè¿‡æ¯ä¸ªæ ·æœ¬æ¥è¿­ä»£æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ¯”ä¸Šé¢çš„æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œè¿­ä»£ä¸€æ¬¡éœ€è¦ç”¨åˆ°æ‰€æœ‰è®­ç»ƒæ ·æœ¬ï¼ˆ<strong>å¾€å¾€å¦‚ä»ŠçœŸå®é—®é¢˜è®­ç»ƒæ•°æ®éƒ½æ˜¯éå¸¸å·¨å¤§</strong>ï¼‰ï¼Œä¸€æ¬¡è¿­ä»£ä¸å¯èƒ½æœ€ä¼˜ï¼Œå¦‚æœè¿­ä»£10æ¬¡çš„è¯å°±éœ€è¦éå†è®­ç»ƒæ ·æœ¬10æ¬¡ã€‚<strong>ä½†æ˜¯ï¼ŒSGDä¼´éšçš„ä¸€ä¸ªé—®é¢˜æ˜¯å™ªéŸ³è¾ƒBGDè¦å¤šï¼Œä½¿å¾—SGDå¹¶ä¸æ˜¯æ¯æ¬¡è¿­ä»£éƒ½å‘ç€æ•´ä½“æœ€ä¼˜åŒ–æ–¹å‘ã€‚</strong></p><h4 id="å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•">å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•</h4><p>æˆ‘ä»¬ä»ä¸Šé¢ä¸¤ç§æ¢¯åº¦ä¸‹é™æ³•å¯ä»¥çœ‹å‡ºï¼Œå…¶å„è‡ªå‡æœ‰ä¼˜ç¼ºç‚¹ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½åœ¨ä¸¤ç§æ–¹æ³•çš„æ€§èƒ½ä¹‹é—´å–å¾—ä¸€ä¸ªæŠ˜è¡·å‘¢ï¼Ÿ**å³ï¼Œç®—æ³•çš„è®­ç»ƒè¿‡ç¨‹æ¯”è¾ƒå¿«ï¼Œè€Œä¸”ä¹Ÿè¦ä¿è¯æœ€ç»ˆå‚æ•°è®­ç»ƒçš„å‡†ç¡®ç‡ï¼Œ**è€Œè¿™æ­£æ˜¯å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼ˆMini-batch Gradient Descentï¼Œç®€ç§°MBGDï¼‰çš„åˆè¡·ã€‚</p><h3 id="æ‹“å±•ï¼šäºŒç»´å»¶å±•è‡³ä¸‰ç»´æ¢¯åº¦ä¸‹é™">æ‹“å±•ï¼šäºŒç»´å»¶å±•è‡³ä¸‰ç»´æ¢¯åº¦ä¸‹é™</h3><p>ä¸¾ä¾‹</p><p>å‡è®¾æœ‰ä¸ªå‡½æ•°</p><p>$f(x,y)=x^2+y^2$</p><p>å¾®åˆ†å¾—</p><p>$f_xâ€™(x,y)=2x$   $f_xâ€™(x,y)=2y$</p><p>å‡è®¾åˆå§‹èµ·ç‚¹ä¸º(5,5)ï¼Œæ­¥é•¿Î±=0.4</p><p>ä»¥æ­¤ç±»æ¨$Î˜^1=Î˜^0âˆ’Î±*J(Î˜)=(5,5)âˆ’0.2âˆ—(10,10)=(3.0,3.0)$</p><p>ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line">ax = plt.figure().add_subplot(projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x*x+y*y</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfx</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>*x</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfy</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>*x</span><br><span class="line">a=<span class="number">0.2</span>   <span class="comment">#æ­¥é•¿</span></span><br><span class="line">x,y=<span class="number">5</span>,<span class="number">5</span> <span class="comment">#åˆå§‹x,yä½ç½®</span></span><br><span class="line">gx=[x]   </span><br><span class="line">gy=[y]   </span><br><span class="line">gz=[f(x,y)]</span><br><span class="line">fcu=fch=f(x,y)</span><br><span class="line">ans=<span class="number">0</span></span><br><span class="line"><span class="comment">#ç®—æ³•</span></span><br><span class="line"><span class="keyword">while</span> ans &lt;<span class="number">100</span> <span class="keyword">and</span> fch&gt; <span class="number">1e-10</span>: <span class="comment">#å½“æ¬¡æ•°å°äº100æ¬¡æˆ–è€…å‡½æ•°å˜åŒ–å°äº1e-10å°±ç»§ç»­è¿›è¡Œä»»åŠ¡</span></span><br><span class="line">    ans+=<span class="number">1</span></span><br><span class="line">    x=x-a*dfx(x)</span><br><span class="line">    y=y-a*dfy(y)</span><br><span class="line">    tmp=f(x,y)</span><br><span class="line">    fch=<span class="built_in">abs</span>(fcu-tmp)</span><br><span class="line">    fcu=tmp</span><br><span class="line">    gx.append(x)</span><br><span class="line">    gy.append(y)</span><br><span class="line">    gz.append(fcu)</span><br><span class="line"><span class="comment"># print(&quot;&#123;:.10f&#125;&quot;.format(gx[3])) #æ— é™æ¥è¿‘0</span></span><br><span class="line">X=np.arange(-<span class="number">5</span>,<span class="number">5</span>,<span class="number">0.1</span>)</span><br><span class="line">Y=np.arange(-<span class="number">5</span>,<span class="number">5</span>,<span class="number">0.1</span>)</span><br><span class="line">Z=np.array(f(X,Y))</span><br><span class="line">ax.plot(X,Y,Z)</span><br><span class="line">ax.plot(gx,gy,gz)</span><br><span class="line">ax.scatter(gx,gy,gz)</span><br><span class="line">plt.title(<span class="string">&quot;$f(x,y)=x^2+y^2$\n$a=%.2f$&quot;</span> % a)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚å›¾</p><p><img src="https://file.imgcc.cloud/images/2024/08/13/68eab393b299ed6d49e022a78b721628.png" alt="image"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;æ¢¯åº¦ä¸‹é™ç®—æ³•&quot;&gt;æ¢¯åº¦ä¸‹é™ç®—æ³•&lt;/h2&gt;
&lt;h3 id=&quot;äºŒç»´æ¢¯åº¦ä¸‹é™&quot;&gt;äºŒç»´æ¢¯åº¦ä¸‹é™&lt;/h3&gt;
&lt;h4 id=&quot;èƒŒæ™¯å¼•å…¥&quot;&gt;èƒŒæ™¯å¼•å…¥&lt;/h4&gt;
&lt;p&gt;â€‹		æ¢¯åº¦ä¸‹é™æ³•ï¼ˆgradient descentï¼‰ï¼Œåˆåæœ€é€Ÿä¸‹é™æ³•ï¼ˆsteepest descentï¼‰æ˜¯æ±‚è§£æ— çº¦</summary>
      
    
    
    
    <category term="äººå·¥æ™ºèƒ½" scheme="https://ruikey.cn/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"/>
    
    
  </entry>
  
</feed>
